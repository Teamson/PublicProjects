System.register("chunks:///_virtual/BoardController.ts",["./rollupPluginModLoBabelHelpers.js","cc","./MainGameController.ts","./Utility.ts","./PHGame_PreBlockAction.ts"],(function(e){"use strict";var t,_,o,n,r,l,i,d,a,u,s,b,p,c,h,m;return{setters:[function(e){t=e.applyDecoratedDescriptor,_=e.inheritsLoose,o=e.initializerDefineProperty,n=e.assertThisInitialized},function(e){r=e.cclegacy,l=e._decorator,i=e.Prefab,d=e.RigidBody2D,a=e.BoxCollider2D,u=e.Collider2D,s=e.instantiate,b=e.Vec3,p=e.Component},function(e){c=e.CardItem},function(e){h=e.default},function(e){m=e.PHGame_PreBlockAction}],execute:function(){var f,C,x,w,g,y,v;r._RF.push({},"c613a8A3I9Gfr8OBIbErqBY","BoardController",void 0);var B=l.ccclass,G=l.property;e("BoardController",(f=B("BoardController"),C=G({type:i}),x=G({type:i}),f((y=t((g=function(e){function t(){for(var t,_=arguments.length,r=new Array(_),l=0;l<_;l++)r[l]=arguments[l];return t=e.call.apply(e,[this].concat(r))||this,o(t,"pre_block_one",y,n(t)),o(t,"pre_block_double",v,n(t)),t.layer_1=null,t.temp_pos=null,t.rigidbody=null,t.boxCollider=null,t.colliderEvent=null,t.recordPos=null,t.DoubleCardBasePool=["b_1_1","b_1_2","b_2_2","b_2_3","b_3_3","b_3_4","b_4_4","b_4_5","b_5_5","b_5_6","b_6_6","b_6_7","b_7_7","b_7_8","b_8_8","b_8_9","b_9_9","w_1_1","w_1_2","w_2_2","w_2_3","w_3_3","w_3_4","w_4_4","w_4_5","w_5_5","w_5_6","w_6_6","w_6_7","w_7_7","w_7_8","w_8_8","w_8_9","w_9_9","t_1_1","t_1_2","t_2_2","t_2_3","t_3_3","t_3_4","t_4_4","t_4_5","t_5_5","t_5_6","t_6_6","t_6_7","t_7_7","t_7_8","t_8_8","t_8_9","t_9_9","o_d_d","o_x_x","o_n_n","o_b_b","o_z_z","o_f_f","o_w_w"],t.OneCardBasePool=["b_1","b_2","b_3","b_4","b_5","b_6","b_7","b_8","b_9","w_1","w_2","w_3","w_4","w_5","w_6","w_7","w_8","w_9","t_1","t_2","t_3","t_4","t_5","t_6","t_7","t_8","t_9","o_d","o_x","o_n","o_b","o_z","o_f","o_w"],t.stratumType_config=[{pos:[{x:-250,d:1},{x:250,d:1}]},{pos:[{x:-250,d:1},{x:0,d:1},{x:250,d:1}]},{pos:[{x:-250,d:1},{x:0,d:0},{x:250,d:1}]},{pos:[{x:-260,d:0},{x:0,d:1},{x:260,d:0}]},{pos:[{x:-250,d:1},{x:-80,d:0},{x:80,d:0},{x:250,d:1}]},{pos:[{x:-260,d:0},{x:-100,d:1},{x:100,d:1},{x:260,d:0}]},{pos:[{x:-260,d:0},{x:-145,d:0},{x:0,d:1},{x:145,d:0},{x:260,d:0}]}],t.index=void 0,t.CardArr=[],t.buffer=[1,2],t.buff_probability=[60,40],t}_(t,e);var r=t.prototype;return r.start=function(){},r.onLoad=function(){this.rigidbody=this.node.getComponent(d),this.boxCollider=this.node.getComponent(a),this.rigidbody.sleep(),this.colliderEvent=this.node.getComponent(u)},r.onEnable=function(){},r.update=function(e){},r.onDisable=function(){},r.init=function(e){this.layer_1=this.node.parent;for(var t=this.stratumType_config[e].pos,_=0;_<t.length;_++){var o=t[_],n=this.onCreateCard(o.x,o.d),r=this.onGetNextCard(o.d);null==r&&(r=this.onGetNextCard(o.d,!0)),n.init(r),n.BoardCtr=this,this.CardArr.push(n)}},r.onCreateCard=function(e,t){var _;(_=s(0==t?this.pre_block_one:this.pre_block_double)).setPosition(new b(e,this.node.position.y+47)),_.setParent(this.layer_1);var o=this.node.getSiblingIndex();return _.setSiblingIndex(o),_.getComponent(m)},r.onGetNextCard=function(e,t){void 0===t&&(t=!1);for(var _=null,o=h.randomProbability(this.buffer,this.buff_probability),n=[],r=0;r<this.layer_1.children.length;r++)"Card_One"!=this.layer_1.children[r].name&&"Card_Double"!=this.layer_1.children[r].name||n.push(this.layer_1.children[r]);if(n.length<=1&&(o=2),t&&(o=2),1==o){var l=null,i=null;if(n.length<=1)null!=(_="o"!=(l=(i=n[0].getComponent(m)).CardItem).name?this.onGetNumCard(l,e):this.onGetOtherCard(l,e))&&(i.isCompleteBlock=!0);else for(var d=0;d<n.length;d++)if(l=(i=n[d].getComponent(m)).CardItem,!i.isCompleteBlock){if(null==l){_=null,this.onGetNextCard(e,!0);break}if(!(1==l.isDouble&&l.double_num_1!=l.double_num_2&&1==e||0==l.isDouble&&0==e||null==(_="o"!=l.name?this.onGetNumCard(l,e):this.onGetOtherCard(l,e)))){i.isCompleteBlock=!0;break}}}else{var a=(0==e?this.OneCardBasePool[h.GetRandom(0,this.OneCardBasePool.length-1)]:this.DoubleCardBasePool[h.GetRandom(0,this.DoubleCardBasePool.length-1)]).split("_"),u=a[0],s=a[1],b="0";0==e?_=new c(0,u,s,s,s,!1):(b=a[2],_=new c(1,u,"-1",s,b,!1))}if(null!=_)return _},r.onGetOtherCard=function(e,t){return new c(t,e.name,e.double_num_1,e.double_num_1,e.double_num_1,!0)},r.onGetNumCard=function(e,t){var _="",o="",n="",r=[];if(e.double_num_1!=e.double_num_2){var l=parseInt(e.double_num_1)-1,i=parseInt(e.double_num_1)+2;"1"!=e.double_num_1&&r.push(l.toString()),"9"!=e.double_num_2&&r.push(i.toString()),parseInt(e.double_num_1)<3?(l=parseInt(e.double_num_1)+1,i=parseInt(e.double_num_1)+2):parseInt(e.double_num_1)>7&&(l=parseInt(e.double_num_1)-2,i=parseInt(e.double_num_1)-1),o=l.toString(),n=i.toString()}else o=n=e.double_num_1,r.push(e.double_num_1);return 0==t?(_=r[h.GetRandom(0,r.length-1)],r.length<2&&(_=r[0]),o=n=_):_="-1",new c(t,e.name,_,o,n,!0)},t}(p)).prototype,"pre_block_one",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=t(g.prototype,"pre_block_double",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=g))||w));r._RF.pop()}}}));

System.register("chunks:///_virtual/BoomEffCtr.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){"use strict";var e,n,o,r,i,a,c,s;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,o=t.initializerDefineProperty,r=t.assertThisInitialized},function(t){i=t.cclegacy,a=t._decorator,c=t.CCFloat,s=t.Component}],execute:function(){var u,f,l,p,h;i._RF.push({},"5e851H92p5J6raPUaajm64J","BoomEffCtr",void 0);var m=a.ccclass,d=a.property;t("BoomEffCtr",(u=m("BoomEffCtr"),f=d(c),u((h=e((p=function(t){function e(){for(var e,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=t.call.apply(t,[this].concat(i))||this,o(e,"time",h,r(e)),e}n(e,t);var i=e.prototype;return i.start=function(){},i.onLoad=function(){},i.update=function(t){},i.onEnable=function(){var t=this;this.scheduleOnce((function(){t.node.destroy()}),this.time)},i.onDisable=function(){},e}(s)).prototype,"time",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.1}}),l=p))||l));i._RF.pop()}}}));

System.register("chunks:///_virtual/HCBlockCtr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./DynamicAssetManager.ts","./Utility.ts","./clientEvent.ts","./EnumController.ts","./HCGameController.ts","./SoundMgr.ts","./PlayerDataMgr.ts"],(function(e){"use strict";var t,n,o,i,s,r,a,l,d,m,C,u,h,_,p,c,b,g,I,f,v,y,D,B,T,S,A,w;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,o=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){s=e.cclegacy,r=e._decorator,a=e.Node,l=e.RigidBody2D,d=e.BoxCollider2D,m=e.Collider2D,C=e.Contact2DType,u=e.Sprite,h=e.SpriteFrame,_=e.UITransform,p=e.Vec3,c=e.math,b=e.instantiate,g=e.tween,I=e.Vec2,f=e.Component},function(e){v=e.default,y=e.AssetsIdName},function(e){D=e.default},function(e){B=e.clientEvent},function(e){T=e.HCGameEvent},function(e){S=e.HCGameController},function(e){A=e.SoundMgr},function(e){w=e.default}],execute:function(){var x,O,P,N,F,z,E,G,U,k,R,H,Y,j,W,L,M;s._RF.push({},"c668dsq/ZNAzYw3rYnTQYEz","HCBlockCtr",void 0);var V=r.ccclass,q=r.property;e("HCBlockCtr",(x=V("HCBlockCtr"),O=q({type:a}),P=q({type:a}),N=q({type:a}),F=q({type:a}),z=q({type:a}),E=q({type:a}),G=q({type:a}),x((R=t((k=function(e){function t(){for(var t,n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return t=e.call.apply(e,[this].concat(s))||this,o(t,"Card",R,i(t)),o(t,"CenterBox",H,i(t)),o(t,"Complete_One",Y,i(t)),o(t,"Complete_Double",j,i(t)),o(t,"Complete_OneOne",W,i(t)),o(t,"Complete_Tip",L,i(t)),o(t,"BoomEff",M,i(t)),t.temp_pos=null,t.original=null,t.CardItem=null,t.rigidbody=null,t.boxCollider=null,t.colliderEvent=null,t.recordPos=null,t.Card_bg=null,t.Card_icon1=null,t.Card_icon2=null,t.index=void 0,t.GameState=void 0,t.isFistColliderSound=!0,t.isComplete=!1,t.isNeedConflate=!1,t.isAddTen=!1,t}n(t,e);var s=t.prototype;return s.start=function(){},s.onLoad=function(){this.Card_bg=D.FindFunc(this.node,"Card_bg"),this.Card_icon1=D.FindFunc(this.node,"Card_icon_1"),this.Card_icon2=D.FindFunc(this.node,"Card_icon_2"),this.rigidbody=this.node.getComponent(l),this.boxCollider=this.node.getComponent(d),this.colliderEvent=this.node.getComponent(m),this.colliderEvent.on(C.STAY_CONTACT,this.onColliderStay,this)},s.update=function(e){},s.onDisable=function(){this.colliderEvent.off(C.STAY_CONTACT,this.onColliderStay,this)},s.init=function(e,t){if(this.GameState=t,1==this.GameState&&(this.isNeedConflate=!0),2==this.GameState&&(this.isAddTen=!0),this.CardItem=e,"Boom"==e.name)return this.Card_bg.getComponent(u).spriteFrame=v.instance.getOneAsset(y.GameUI,"mj_pf_"+(w.getPlayerData().skinId_Use+1)+"_1",h),this.Card_icon1.getComponent(u).spriteFrame=v.instance.getOneAsset(y.GameUI,"tx_zd",h),this.Card_bg.getComponent(_).width=72,this.Card_bg.getComponent(_).height=102,this.Card_icon2.active=!1,this.Card_icon1.position=new p(0,1.3),void(this.boxCollider.size=c.size(72,102));0==this.CardItem.isDouble?(this.Card_bg.getComponent(u).spriteFrame=v.instance.getOneAsset(y.GameUI,"mj_pf_"+(w.getPlayerData().skinId_Use+1)+"_1",h),this.Card_icon1.getComponent(u).spriteFrame=v.instance.getOneAsset(y.GameUI,"mj_"+this.CardItem.name+"_0"+this.CardItem.one_num,h),this.Card_bg.getComponent(_).width=72,this.Card_bg.getComponent(_).height=102,this.Card_icon2.active=!1,this.Card_icon1.position=new p(0,1.3),this.boxCollider.size=c.size(72,102)):(this.Card_bg.getComponent(u).spriteFrame=v.instance.getOneAsset(y.GameUI,"mj_pf_"+(w.getPlayerData().skinId_Use+1)+"_3",h),this.Card_icon1.getComponent(u).spriteFrame=v.instance.getOneAsset(y.GameUI,"mj_"+this.CardItem.name+"_0"+this.CardItem.double_num_1,h),this.Card_icon2.getComponent(u).spriteFrame=v.instance.getOneAsset(y.GameUI,"mj_"+this.CardItem.name+"_0"+this.CardItem.double_num_2,h),this.Card_icon2.active=!0,this.Card_bg.getComponent(_).width=144,this.Card_bg.getComponent(_).height=102,this.Card_icon1.position=new p(-33,1.3),this.Card_icon2.position=new p(33,1.3),this.boxCollider.size=c.size(144,102))},s.onColliderStay=function(e,n,o){if(!this.isFistColliderSound||"Card"!=n.node.name&&"Wall_Bottom"!=n.node.name||(this.isFistColliderSound=!1,D.DoVibrate(),A._ins.PlaySound("HeCheng_XiaLuo")),"Boom"==this.CardItem.name&&("Card"==n.node.name||"Wall_Bottom"==n.node.name)){this.node.active=!1,B.dispatchEvent(T.BoomCardColliderCB,[this]);var i=b(this.BoomEff);return i.active=!0,this.node.parent.addChild(i),i.scale=new p(2,2),void(i.position=this.node.position)}if("Card"==n.node.name){var s=n.node.getComponent(t);if(s.rigidbody.enabledContactListener){var r=s.CardItem;if(!this.isComplete&&!s.isComplete)if("l"!=this.CardItem.name&&"l"!=r.name){if(this.CardItem.name==r.name)return this.isAddTen?"o"==this.CardItem.name&&this.CardItem.double_num_1==r.double_num_1?void this.onCompleteCB(s):void(0==this.CardItem.isDouble?(0==r.isDouble&&parseInt(this.CardItem.one_num)+parseInt(r.one_num)==10&&this.onCompleteCB(s),1==r.isDouble&&parseInt(this.CardItem.one_num)+parseInt(r.double_num_1)+parseInt(r.double_num_2)==10&&this.onCompleteCB(s)):(0==r.isDouble&&parseInt(this.CardItem.double_num_1)+parseInt(this.CardItem.double_num_2)+parseInt(r.one_num)==10&&this.onCompleteCB(s),1==r.isDouble&&parseInt(this.CardItem.double_num_1)+parseInt(this.CardItem.double_num_2)+parseInt(r.double_num_1)+parseInt(r.double_num_2)==10&&this.onCompleteCB(s))):void(this.isNeedConflate?0==this.CardItem.isDouble&&(0==r.isDouble&&r.one_num==this.CardItem.one_num&&this.onCompleteCB(s),0==r.isDouble&&parseInt(r.one_num)==parseInt(this.CardItem.one_num)-1&&this.onCompleteCB(s),0==r.isDouble&&parseInt(r.one_num)==parseInt(this.CardItem.one_num)+1&&this.onCompleteCB(s)):0==this.CardItem.isDouble?(1==r.isDouble&&r.double_num_1==this.CardItem.double_num_2&&r.double_num_1==this.CardItem.one_num&&r.double_num_2==this.CardItem.one_num&&this.onCompleteCB(s),1==r.isDouble&&parseInt(r.double_num_2)==parseInt(this.CardItem.one_num)-1&&r.double_num_1!=r.double_num_2&&this.onCompleteCB(s),1==r.isDouble&&parseInt(r.double_num_1)==parseInt(this.CardItem.one_num)+1&&r.double_num_1!=r.double_num_2&&this.onCompleteCB(s)):(1==r.isDouble&&this.CardItem.double_num_1==this.CardItem.double_num_2&&r.double_num_1==this.CardItem.double_num_1&&r.double_num_2==this.CardItem.double_num_2&&this.onCompleteCB(s),0==r.isDouble&&this.CardItem.double_num_1==this.CardItem.double_num_2&&r.one_num==this.CardItem.double_num_1&&this.onCompleteCB(s),0==r.isDouble&&this.CardItem.double_num_1!=this.CardItem.double_num_2&&parseInt(r.one_num)==parseInt(this.CardItem.double_num_1)-1&&this.onCompleteCB(s),0==r.isDouble&&this.CardItem.double_num_1!=this.CardItem.double_num_2&&parseInt(r.one_num)==parseInt(this.CardItem.double_num_2)+1&&this.onCompleteCB(s)))}else this.onCompleteCB(s)}}},s.onCompleteCB=function(e){var t=this;this.isComplete||(this.isNeedConflate?this.scheduleOnce((function(){t.onConflatePair(e)})):this.onDefaultComplete(e))},s.onConflatePair=function(e){this.isNeedConflate=!1,e.isNeedConflate=!1,this.colliderEvent.off(C.STAY_CONTACT,this.onColliderStay,this),e.colliderEvent.off(C.STAY_CONTACT,this.onColliderStay,this),this.node.parent.parent.parent.getComponent(S).onNewConflatePairCard(this,e)},s.onDefaultComplete=function(e){B.dispatchEvent(T.onUpdateCompleteNum),this.isComplete=!0,e.isComplete=!0,this.isNeedConflate=!1,e.isNeedConflate=!1,this.colliderEvent.off(C.STAY_CONTACT,this.onColliderStay,this),e.colliderEvent.off(C.STAY_CONTACT,this.onColliderStay,this),this.node.setParent(this.CenterBox),e.node.setParent(this.CenterBox);var t=e.getIndex(),n=this.getIndex();n<t&&(t=n);var o=[];o.push(this),o.push(e);for(var i=this.Complete_Double,s=!0,r=0,a=!1,l=1,d=0,m=o;d<m.length;d++){var c=m[d];"l"==c.CardItem.name&&(a=!0),this.isAddTen&&0==c.CardItem.isDouble&&r++,"l"!=c.CardItem.name&&0==c.CardItem.isDouble&&(s=!1,i=this.Complete_One)}r>=2&&(s=!0),a&&!s?i=this.Complete_OneOne:a&&s?i=this.Complete_One:a||s?!a&&s&&(i=this.Complete_Double):i=this.Complete_One,this.isAddTen&&s&&(i=this.Complete_OneOne);var I=b(i);I.setParent(this.CenterBox),this.CenterBox.insertChild(I,t),I.setPosition(i.getPosition());for(var f=0,S=o;f<S.length;f++){var w=S[f];w.rigidbody.sleep(),w.rigidbody.enabled=!1,w.boxCollider.enabled=!1,g(w.node).to(.2,{angle:0}).start();var x=I.getComponent(_).convertToWorldSpaceAR(I.children[0].children[l].position),O=this.CenterBox.getComponent(_).convertToNodeSpaceAR(x);0==w.CardItem.isDouble&&i==this.Complete_One?(x=I.getComponent(_).convertToWorldSpaceAR(I.children[0].children[1].position),O=this.CenterBox.getComponent(_).convertToNodeSpaceAR(x)):0!=w.CardItem.isDouble&&i==this.Complete_One&&(x=I.getComponent(_).convertToWorldSpaceAR(I.children[0].children[2].position),O=this.CenterBox.getComponent(_).convertToNodeSpaceAR(x)),g(w.node).to(.2,{position:O}).call((function(){I.children[0].active=!0})).start(),l++}var P=b(this.Complete_Tip);P.setParent(this.CenterBox),this.CenterBox.insertChild(P,t);var N=o[0].CardItem,F=o[1].CardItem,z="tx_c";switch(s?z="tx_g":(1==N.isDouble&&N.double_num_1==N.double_num_2||1==F.isDouble&&F.double_num_1==F.double_num_2)&&(z="tx_p"),this.isAddTen&&(z="tx_cou"),D.DoVibrate(),z){case"tx_c":A._ins.PlaySound("wh_woman_chi");break;case"tx_g":A._ins.PlaySound("wh_woman_gang");break;case"tx_p":A._ins.PlaySound("wh_woman_peng");break;case"tx_cou":A._ins.PlaySound("wh_woman_hu")}var E=v.instance.getOneAsset(y.GameUI,z,h);P.children[1].getComponent(u).spriteFrame=E,P.setPosition(this.Complete_Tip.getPosition()),P.children[0].active=!0,P.children[1].active=!0,this.scheduleOnce((function(){P.children[2].active=!0,g(P.children[2]).to(.2,{angle:180}).start()}),.3),g(P.children[1]).to(.1,{position:new p(0,0)}).to(.1,{scale:new p(1.2,1.2,1.2)}).to(.1,{scale:new p(1,1,1)}).start(),this.scheduleOnce((function(){for(var e=0,t=o;e<t.length;e++){var n=t[e];I.destroy(),P.destroy(),n.node.destroy()}}),1)},s.getIndex=function(){return this.node.getSiblingIndex()},s.addUpForce=function(){this.rigidbody.enabled=!0,this.rigidbody.wakeUp();var e=0==D.GetRandom(0,1)?1:-1;this.rigidbody.applyForceToCenter(new I(5e3*e,1e4),!0)},s.clone_block=function(e,n){var o=b(n),i=o.getComponent(t);o.setParent(e);var s=this.node.getWorldPosition(),r=e.getComponent(_).convertToNodeSpaceAR(s);return o.setPosition(r),i.init(this.CardItem,this.GameState),i.original=this,this.node.active=!1,i},s.set_temp_pos=function(e){this.temp_pos=e},s.get_temp_pos=function(){return this.temp_pos},t}(f)).prototype,"Card",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),H=t(k.prototype,"CenterBox",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Y=t(k.prototype,"Complete_One",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j=t(k.prototype,"Complete_Double",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),W=t(k.prototype,"Complete_OneOne",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),L=t(k.prototype,"Complete_Tip",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M=t(k.prototype,"BoomEff",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),U=k))||U));s._RF.pop()}}}));

System.register("chunks:///_virtual/HCGameController.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UI.ts","./Utility.ts","./MainGameController.ts","./HCBlockCtr.ts","./clientEvent.ts","./EnumController.ts","./PlayerDataMgr.ts","./DynamicAssetManager.ts","./UIManager.ts","./Entity.ts","./SGAD.ts","./UserGuide2.ts","./SoundMgr.ts","./GameLogic.ts"],(function(e){"use strict";var t,n,o,i,a,s,l,r,h,d,m,C,u,c,_,p,b,v,f,g,G,B,w,N,y,I,x,S,L,T,F,D,P,M,O,U,A;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,o=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){a=e.cclegacy,s=e._decorator,l=e.Node,r=e.Prefab,h=e.Label,d=e.Input,m=e.find,C=e.ProgressBar,u=e.tween,c=e.Vec3,_=e.ERigidBody2DType,p=e.instantiate,b=e.SpriteFrame,v=e.Sprite,f=e.UITransform,g=e.UIOpacity,G=e.Vec2,B=e.RigidBody2D},function(e){w=e.default},function(e){N=e.default},function(e){y=e.CardItem},function(e){I=e.HCBlockCtr},function(e){x=e.clientEvent},function(e){S=e.HCGameEvent},function(e){L=e.default},function(e){T=e.default,F=e.AssetsIdName},function(e){D=e.default},function(e){P=e.UIType},function(e){M=e.default},function(e){O=e.UserGuide},function(e){U=e.SoundMgr},function(e){A=e.GameLogic}],execute:function(){var H,E,k,R,V,j,z,Z,X;a._RF.push({},"60973L1XtJLJIp1zoFHMGL7","HCGameController",void 0);var J=s.ccclass,W=s.property;e("HCGameController",(H=J("HCGameController"),E=W(l),k=W(l),R=W(r),H((z=t((j=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return t=e.call.apply(e,[this].concat(a))||this,o(t,"Card",z,i(t)),o(t,"GameBox",Z,i(t)),o(t,"hcEff",X,i(t)),t.CenterBox=void 0,t.ClickMoveTip=void 0,t.CompleteBox=void 0,t.CompleteNewIcon=void 0,t.CompleteNumLabel=void 0,t.ComboBox=void 0,t.ComboNumLabel=void 0,t.ShowLoseTip=void 0,t.ComboEff=void 0,t.ComboTexNode=void 0,t.LevelIcon_1=null,t.LevelIcon_2=null,t.LevelIcon_3=null,t.LevelNameIcon_1=null,t.LevelNameIcon_2=null,t.LevelNameIcon_3=null,t.LevelNeedLabel=null,t.DisarrangeBtn=null,t.CleanCardBtn=null,t.OmnipotentBtn=null,t.BoomBtn=null,t.isInLaZi=!1,t.GameState=2,t.DoubleCardBasePool=["b_1_1","b_1_2","b_2_2","b_2_3","b_3_3","b_3_4","b_4_4","b_4_5","b_5_5","b_5_6","b_6_6","b_6_7","b_7_7","b_7_8","b_8_8","b_8_9","b_9_9","w_1_1","w_1_2","w_2_2","w_2_3","w_3_3","w_3_4","w_4_4","w_4_5","w_5_5","w_5_6","w_6_6","w_6_7","w_7_7","w_7_8","w_8_8","w_8_9","w_9_9","t_1_1","t_1_2","t_2_2","t_2_3","t_3_3","t_3_4","t_4_4","t_4_5","t_5_5","t_5_6","t_6_6","t_6_7","t_7_7","t_7_8","t_8_8","t_8_9","t_9_9","o_d_d","o_x_x","o_n_n","o_b_b","o_z_z","o_f_f","o_w_w"],t.OneCardBasePool=["b_1","b_2","b_3","b_4","b_5","b_6","b_7","b_8","b_9","w_1","w_2","w_3","w_4","w_5","w_6","w_7","w_8","w_9","t_1","t_2","t_3","t_4","t_5","t_6","t_7","t_8","t_9","o_d","o_x","o_n","o_b","o_z","o_f","o_w"],t.CanMoveCard=null,t.CompleteCardNum=void 0,t.effComboNum=0,t.comboTween=null,t.level=1,t.level_add=0,t.level_need=0,t.OneGameDelBuffNum=0,t.pro_level=1,t.levelArr=[5,20,50,80,150,280,380,500,650,800,1e3],t.buffer=[1,2],t.buff_probability=[100,0],t.isShowLoseTip=!1,t.isGameOver=!1,t.isCanAgainGame=!0,t}n(t,e);var a=t.prototype;return a.onLoad=function(){this.GameState=parseInt(this.parm[0][0]),this.ClickMoveTip=N.FindFunc(this.node,"ClickMoveTip"),this.CenterBox=N.FindFunc(this.node,"CenterBox"),this.CompleteBox=N.FindFunc(this.node,"CompleteBox"),this.CompleteNewIcon=N.FindFunc(this.node,"CompleteNewIcon"),this.ComboBox=N.FindFunc(this.node,"ComboBox"),this.ShowLoseTip=N.FindFunc(this.node,"ShowLoseTip"),this.ComboEff=N.FindFunc(this.node,"ComboEff"),this.ComboTexNode=N.FindFunc(this.ComboEff,"ComboTexNode"),this.LevelIcon_1=N.FindFunc(this.node,"LevelIcon_1"),this.LevelIcon_2=N.FindFunc(this.node,"LevelIcon_2"),this.LevelIcon_3=N.FindFunc(this.node,"LevelIcon_3"),this.LevelNameIcon_1=N.FindFunc(this.node,"LevelNameIcon_1"),this.LevelNameIcon_2=N.FindFunc(this.node,"LevelNameIcon_2"),this.LevelNameIcon_3=N.FindFunc(this.node,"LevelNameIcon_3"),this.DisarrangeBtn=N.FindFunc(this.node,"DisarrangeBtn"),this.CleanCardBtn=N.FindFunc(this.node,"CleanCardBtn"),this.OmnipotentBtn=N.FindFunc(this.node,"OmnipotentBtn"),this.BoomBtn=N.FindFunc(this.node,"BoomBtn"),this.CompleteNumLabel=N.FindFunc(this.node,"CompleteNumLabel").getComponent(h),this.ComboNumLabel=N.FindFunc(this.node,"ComboNumLabel").getComponent(h),this.LevelNeedLabel=N.FindFunc(this.node,"LevelNeedLabel").getComponent(h),this.CenterBox.on(d.EventType.TOUCH_MOVE,this.touch_move,this),this.CenterBox.on(d.EventType.TOUCH_END,this.touch_end,this),this.CenterBox.on(d.EventType.TOUCH_CANCEL,this.touch_end,this),x.on(S.onUpdateCompleteNum,this.onUpdateCompleteNum,this),x.on(S.onFinishAgainGame,this.onFinishAgainGame,this),x.on(S.onAgainGameEvent,this.onAgainGame,this),x.on(S.BoomCardColliderCB,this.BoomCardColliderCB,this)},a.onEnable=function(){this.CompleteCardNum=0,1==this.GameState&&(this.OneGameDelBuffNum=20),this.GameBox.children.length<=0?(N.setInteractableState(this.DisarrangeBtn,!1),N.setInteractableState(this.CleanCardBtn,!1)):(N.setInteractableState(this.DisarrangeBtn,!0),N.setInteractableState(this.CleanCardBtn,!0)),this.onGetFirstCard(),this.onGetNextCard(),this.onUpdateCompleteNum(!0),this.onUpdateLevelPro(),this.onShowLoseTipAnim(),this.ShowLoseTip.active=!1,0==this.GameState&&L.getPlayerData().isFisrtGame_HC_1?this.scheduleOnce((function(){m("Canvas").getComponent(O).setGuideTextPos("follow"),m("Canvas").getComponent(O).setGuideTextBackgroundScale(1.2,1.2),m("Canvas").getComponent(O).setGuideTextFontSize(30),m("Canvas").getComponent(O).showGuideByGroup([15,16],(function(){L.getPlayerData().isFisrtGame_HC_1=!1,L.setPlayerData()}))}),.1):1==this.GameState&&L.getPlayerData().isFisrtGame_HC_2?this.scheduleOnce((function(){m("Canvas").getComponent(O).setGuideTextPos("follow"),m("Canvas").getComponent(O).setGuideTextBackgroundScale(1.2,1.2),m("Canvas").getComponent(O).setGuideTextFontSize(20),m("Canvas").getComponent(O).showGuideByGroup([17,18],(function(){L.getPlayerData().isFisrtGame_HC_2=!1,L.setPlayerData()}))}),.1):2==this.GameState&&L.getPlayerData().isFisrtGame_HC_3&&this.scheduleOnce((function(){m("Canvas").getComponent(O).setGuideTextPos("follow"),m("Canvas").getComponent(O).setGuideTextBackgroundScale(1.2,1.2),m("Canvas").getComponent(O).setGuideTextFontSize(20),m("Canvas").getComponent(O).showGuideByGroup([19,20],(function(){L.getPlayerData().isFisrtGame_HC_3=!1,L.setPlayerData()}))}),.1)},a.onDisable=function(){x.off(S.BoomCardColliderCB,this.BoomCardColliderCB,this),x.off(S.onUpdateCompleteNum,this.onUpdateCompleteNum,this),x.off(S.onFinishAgainGame,this.onFinishAgainGame,this),x.off(S.onAgainGameEvent,this.onAgainGame,this)},a.onShowComboEff=function(){var e=this;this.effComboNum>=4&&(this.effComboNum=4);for(var t=0;t<this.ComboTexNode.children.length;t++)this.ComboTexNode.children[t].active=!1;this.ComboTexNode.children[this.effComboNum].active=!0,null!=this.comboTween&&(this.comboTween.stop(),this.comboTween=null);var n=this.ComboEff.children[1].getComponent(C);n.progress=0,this.ComboEff.active=!0,this.comboTween=u(n).to(5,{progress:1}).call((function(){e.effComboNum=0,e.comboTween=null,e.ComboEff.active=!1})),this.comboTween.start(),this.effComboNum++},a.onAgainGame=function(){this.isGameOver=!1,this.CompleteCardNum=0,this.ShowLoseTip.active=!1,this.GameBox.removeAllChildren(),this.GameBox.children.length<=0?(N.setInteractableState(this.DisarrangeBtn,!1),N.setInteractableState(this.CleanCardBtn,!1)):(N.setInteractableState(this.DisarrangeBtn,!0),N.setInteractableState(this.CleanCardBtn,!0)),this.onGetFirstCard(),this.onGetNextCard(),this.onUpdateCompleteNum(!0),this.onUpdateLevelPro(),this.onShowLoseTipAnim()},a.touch_move=function(e){if(null!=this.CanMoveCard){var t=e.getUILocation();null!=this.CanMoveCard&&1==this.CanMoveCard.getComponent(I).CardItem.isDouble?t.x>=75&&t.x<=650&&(this.CanMoveCard.position=new c(t.x-360,this.CanMoveCard.position.y),this.ClickMoveTip.position=new c(t.x-360,this.ClickMoveTip.position.y)):null!=this.CanMoveCard&&0==this.CanMoveCard.getComponent(I).CardItem.isDouble&&t.x>=45&&t.x<=680&&(this.CanMoveCard.position=new c(t.x-360,this.CanMoveCard.position.y),this.ClickMoveTip.position=new c(t.x-360,this.ClickMoveTip.position.y))}},a.touch_end=function(e){if(null!=this.CanMoveCard){this.isInLaZi&&(this.isInLaZi=!1);var t=this.CanMoveCard.getComponent(I);t.rigidbody.enabledContactListener=!0,this.CanMoveCard=null,t.rigidbody.wakeUp(),t.rigidbody.type=_.Dynamic,this.ClickMoveTip.active=!1,this.GameBox.children.length<=0?(N.setInteractableState(this.DisarrangeBtn,!1),N.setInteractableState(this.CleanCardBtn,!1)):(N.setInteractableState(this.DisarrangeBtn,!0),N.setInteractableState(this.CleanCardBtn,!0)),this.scheduleOnce(this.onGetNextToNowCard,1)}},a.DisarrangeBtnCB=function(){var e=this;M.showVideoAd((function(){N.DoVibrate(),U._ins.PlaySound("HeCheng_XiPai");for(var t=0;t<e.GameBox.children.length;t++){e.GameBox.children[t].getComponent(I).addUpForce()}}),(function(){N.showToast("看完视频才能获得奖励哦！")}))},a.CleanCardBtnCB=function(){var e=this;M.showVideoAd((function(){if(e.GameBox.children.length<=2)e.GameBox.children[0].destroy();else{var t=N.GetRandom(0,e.GameBox.children.length-2);e.GameBox.children[t].destroy()}}),(function(){N.showToast("看完视频才能获得奖励哦！")}))},a.OmnipotentBtnCB=function(){var e=this;this.isInLaZi?N.showToast("已拥有赖子牌!"):M.showVideoAd((function(){e.isInLaZi=!0,e.ClickMoveTip.active=!1;for(var t=0;t<e.GameBox.children.length;t++)e.GameBox.children[t].position.y>=515&&e.GameBox.children[t].destroy();var n,o=null;n=new y(0,"l","-1","1","1",!1),o=p(e.Card),e.GameBox.addChild(o),o.scale=new c(1,1),o.position=new c(0,515,0),o.getComponent(I).init(n,0),o.getComponent(I).rigidbody.enabled=!0,o.getComponent(I).boxCollider.enabled=!0,e.CanMoveCard=o,e.ClickMoveTip.active=!0}),(function(){N.showToast("看完视频才能获得奖励哦！")}))},a.BoomBtnCB=function(){var e=this;M.showVideoAd((function(){e.ClickMoveTip.active=!1;for(var t=0;t<e.GameBox.children.length;t++)e.GameBox.children[t].position.y>=515&&e.GameBox.children[t].destroy();var n,o=null;n=new y(0,"Boom","-1","1","1",!1),o=p(e.Card),e.GameBox.addChild(o),o.scale=new c(1,1),o.position=new c(0,515,0),o.getComponent(I).init(n,0),o.getComponent(I).rigidbody.enabled=!0,o.getComponent(I).boxCollider.enabled=!0,e.CanMoveCard=o,e.ClickMoveTip.active=!0}),(function(){N.showToast("看完视频才能获得奖励哦！")}))},a.BoomCardColliderCB=function(e){N.DoVibrate(),U._ins.PlaySound("HeCheng_XiaoChu");for(var t=e[0],n=[],o=(this.GameBox.children.length,0);o<this.GameBox.children.length;o++){var i=this.GameBox.children[o].getComponent(I);N.getDistance(t.node.position,i.node.position)<=300&&n.push(i)}for(var a=0;a<n.length;a++)n[a].node.destroy()},a.SetBtnCB=function(){A.Share.onShowSetPopUI()},a.onUpdateCompleteNum=function(e){void 0===e&&(e=!1),this.GameBox.children.length<=0?(N.setInteractableState(this.DisarrangeBtn,!1),N.setInteractableState(this.CleanCardBtn,!1)):(N.setInteractableState(this.DisarrangeBtn,!0),N.setInteractableState(this.CleanCardBtn,!0)),e||(this.CompleteCardNum+=1*(this.effComboNum+1),this.onShowComboEff()),this.CompleteCardNum>L.getPlayerData().HCGameMaxCompleteNum?(this.CompleteNewIcon.active=!0,this.CompleteNumLabel.string=this.CompleteCardNum.toString(),L.getPlayerData().HCGameMaxCompleteNum=this.CompleteCardNum,L.setPlayerData()):this.CompleteNumLabel.string=L.getPlayerData().HCGameMaxCompleteNum.toString(),this.ComboNumLabel.string=this.CompleteCardNum.toString(),0==this.GameState&&this.CompleteCardNum>=280?(L.getPlayerData().HCGameTypeVideoNum_2=3,L.getPlayerData().isCanPlayHCGameType_2=!0,L.setPlayerData()):0==this.GameState&&this.CompleteCardNum>=500&&(L.getPlayerData().HCGameTypeVideoNum_3=3,L.getPlayerData().isCanPlayHCGameType_3=!0,L.setPlayerData());var t=0,n=0;this.CompleteCardNum<=3?(t=100-this.OneGameDelBuffNum,n=0+this.OneGameDelBuffNum,this.buff_probability=[t,n]):this.CompleteCardNum>3&&this.CompleteCardNum<=6?(t=80-this.OneGameDelBuffNum,n=20+this.OneGameDelBuffNum,this.buff_probability=[t,n]):this.CompleteCardNum>6&&this.CompleteCardNum<=9?(t=60-this.OneGameDelBuffNum,n=40+this.OneGameDelBuffNum,this.buff_probability=[t,n]):this.CompleteCardNum>9&&(t=40-this.OneGameDelBuffNum,n=60+this.OneGameDelBuffNum,this.buff_probability=[t,n]),this.onUpdateLevelPro()},a.onUpdateLevelPro=function(){if(!(this.level>=12)){var e=this.levelArr[this.level-1];if(this.CompleteCardNum>=e)return this.level++,void this.onUpdateLevelPro();var t=this.CompleteCardNum/e;this.LevelNeedLabel.string=Math.floor(100*t).toString()+"%",this.onUpdateLevelBoxIcon()}},a.onUpdateLevelBoxIcon=function(){if(!(this.level>=10)){N.DoVibrate(),U._ins.PlaySound("FuTou");var e="0"+this.level,t="0"+(this.level+1),n="0"+(this.level+2);this.level>=10&&(e=this.level.toString()),this.level+1>=10&&(t=(this.level+1).toString()),this.level+2>=10&&(n=(this.level+2).toString());var o=T.instance.getOneAsset(F.GameUI,"jcwf_dj_"+e+"_02",b),i=T.instance.getOneAsset(F.GameUI,"jcwf_dj_"+t+"_02",b),a=T.instance.getOneAsset(F.GameUI,"jcwf_dj_"+n+"_02",b),s=T.instance.getOneAsset(F.GameUI,"jcwf_dj_"+e,b),l=T.instance.getOneAsset(F.GameUI,"jcwf_dj_"+t,b),r=T.instance.getOneAsset(F.GameUI,"jcwf_dj_"+n,b);this.LevelIcon_1.getComponent(v).spriteFrame=o,this.LevelIcon_2.getComponent(v).spriteFrame=i,this.LevelIcon_3.getComponent(v).spriteFrame=a,this.LevelNameIcon_1.getComponent(v).spriteFrame=s,this.LevelNameIcon_2.getComponent(v).spriteFrame=l,this.LevelNameIcon_3.getComponent(v).spriteFrame=r}},a.onGetNextToNowCard=function(){var e=p(this.Card),t=this.Card.getComponent(I).CardItem;this.GameBox.addChild(e),e.scale=new c(1,1),e.position=new c(0,515,0),e.getComponent(I).init(t,this.GameState),e.getComponent(I).rigidbody.enabledContactListener=!1,e.getComponent(I).rigidbody.enabled=!0,e.getComponent(I).boxCollider.enabled=!0,this.CanMoveCard=e,this.ClickMoveTip.position=new c(0,this.ClickMoveTip.position.y),this.ClickMoveTip.active=!0,0==t.isDouble?this.ClickMoveTip.getComponent(f).width=72:this.ClickMoveTip.getComponent(f).width=144,this.onGetNextCard()},a.onGetFirstCard=function(){var e=null,t=null,n=N.GetRandom(0,1);1==this.GameState&&(n=0);var o=(0==n?this.OneCardBasePool[N.GetRandom(0,this.OneCardBasePool.length-1)]:this.DoubleCardBasePool[N.GetRandom(0,this.DoubleCardBasePool.length-1)]).split("_"),i=o[0],a=o[1],s="1";0==n?t=new y(0,i,a,a,a,!1):(s=o[2],t=new y(1,i,"-1",a,s,!1)),1==n&&parseInt(a)+parseInt(s)>=10?this.onGetFirstCard():(e=p(this.Card),this.GameBox.addChild(e),e.scale=new c(1,1),e.position=new c(0,515,0),e.getComponent(I).init(t,this.GameState),e.getComponent(I).rigidbody.enabledContactListener=!1,this.CanMoveCard=e,this.ClickMoveTip.getComponent(f).width=0==n?72:144)},a.onGetNextCard=function(e){void 0===e&&(e=!1);var t=null,n=N.randomProbability(this.buffer,this.buff_probability);if(this.GameBox.children.length<=2&&(n=2),e&&(n=2),1==n){var o=null;if(this.GameBox.children.length<=2){if("l"==(o=this.GameBox.children[0].getComponent(I).CardItem).name)return void this.onGetNextCard(!0);t="o"!=o.name?this.onGetNumCard(o,!0):this.onGetOtherCard(o,!0)}else{var i=N.GetRandom(0,this.GameBox.children.length-1);if(i>=this.GameBox.children.length&&(i=0),"l"==(o=this.GameBox.children[i].getComponent(I).CardItem).name)return void this.onGetNextCard(!0);t="o"!=o.name?this.onGetNumCard(o,!0):this.onGetOtherCard(o,!0)}}else{var a=N.GetRandom(0,1);1==this.GameState&&(a=0);var s=(0==a?this.OneCardBasePool[N.GetRandom(0,this.OneCardBasePool.length-1)]:this.DoubleCardBasePool[N.GetRandom(0,this.DoubleCardBasePool.length-1)]).split("_"),l=s[0],r=s[1],h="0";if(0==a?t=new y(0,l,r,r,r,!1):(h=s[2],t=new y(1,l,"-1",r,h,!1)),1==a&&parseInt(r)+parseInt(h)>=10)return t=null,void this.onGetNextCard()}null!=t&&(this.Card.getComponent(I).init(t,this.GameState),this.Card.getComponent(I).rigidbody.enabledContactListener=!1,this.Card.getComponent(I).rigidbody.enabled=!1,this.Card.getComponent(I).boxCollider.enabled=!1)},a.onNewConflatePairCard=function(e,t){N.DoVibrate(),U._ins.PlaySound("FuTou"),e.isNeedConflate=!1,t.isNeedConflate=!1;var n=[];n.push(e),n.push(t);var o=e.CardItem.one_num,i=t.CardItem.one_num;o>i&&(o=t.CardItem.one_num,i=e.CardItem.one_num);for(var a=new y(1,e.CardItem.name,"-1",o,i,!1),s=0,l=n;s<l.length;s++){var r=l[s];r.rigidbody.sleep(),r.rigidbody.enabled=!1,r.boxCollider.enabled=!1,r.node.destroy()}var h=null;h=p(this.Card);var d=null;(d=p(this.hcEff)).active=!0,this.GameBox.addChild(h),h.scale=new c(1,1),h.position=e.node.position,h.getComponent(I).init(a,0),h.getComponent(I).rigidbody.enabledContactListener=!0,h.getComponent(I).rigidbody.type=_.Dynamic,h.getComponent(I).rigidbody.enabled=!0,h.getComponent(I).boxCollider.enabled=!0,this.GameBox.addChild(d),d.position=e.node.position},a.onGetOtherCard=function(e,t){void 0===t&&(t=!1);var n=N.GetRandom(0,1);return t&&0==e.isDouble&&(n=1),1==this.GameState&&(n=0),new y(n,e.name,e.double_num_1,e.double_num_1,e.double_num_1,!0)},a.onGetNumCard=function(e,t){void 0===t&&(t=!1);var n=N.GetRandom(0,1),o="",i="",a="",s=[];1!=e.isDouble||"1"!=e.double_num_1&&"9"!=e.double_num_2||(n=0),1==e.isDouble&&e.double_num_1!=e.double_num_2&&(n=0),t&&0==e.isDouble&&(n=1),1==this.GameState&&(n=0);var l=0,r=0,h=0;if(2==this.GameState)return(l=10-(0==e.isDouble?parseInt(e.one_num):parseInt(e.double_num_1)+parseInt(e.double_num_2)))<=2&&(n=0),0==n?i=a=o=l.toString():(o="-1",h=l-(r=Math.floor(l/2)),i=r.toString(),a=h.toString()),new y(n,e.name,o,i,a,!0);if(e.double_num_1!=e.double_num_2){var d=parseInt(e.double_num_1)-1,m=parseInt(e.double_num_1)+2;"1"!=e.double_num_1&&s.push(d.toString()),"9"!=e.double_num_2&&s.push(m.toString()),parseInt(e.double_num_1)<3?(d=parseInt(e.double_num_1)+1,m=parseInt(e.double_num_1)+2):parseInt(e.double_num_1)>7&&(d=parseInt(e.double_num_1)-2,m=parseInt(e.double_num_1)-1),i=d.toString(),a=m.toString()}else i=a=e.double_num_1,s.push(e.double_num_1);return 0==n?(o=s[N.GetRandom(0,s.length-1)],s.length<2&&(o=s[0]),i=a=o):o="-1",new y(n,e.name,o,i,a,!0)},a.onShowAgainPopUI=function(){this.isCanAgainGame=!1,D.GetInstance().openPopup(F.HCGameUI,P.HCGamePopUI,!1,[this.CompleteCardNum])},a.onFinishAgainGame=function(){this.isGameOver=!1,this.ShowLoseTip.active=!1;for(var e=Math.floor(this.GameBox.children.length/2),t=0;t<e;t++)this.GameBox.children[this.GameBox.children.length-1].destroy()},a.onGameOverCB=function(){this.isGameOver||(this.isGameOver=!0,U._ins.PlaySound("ShiBai"),this.isCanAgainGame?this.onShowAgainPopUI():D.GetInstance().openPopup(F.MainUI,P.OtherGameFinishPopUI,!1,[this.CompleteCardNum]))},a.onShowLoseTipAnim=function(){u(this.ShowLoseTip.getComponent(g)).to(.3,{opacity:0}).to(.3,{opacity:255}).union().repeatForever().start()},a.onShowLoseTip=function(){if(this.GameBox.children.length<=5)return this.isShowLoseTip=!1,void(this.ShowLoseTip.active=!1);for(var e=!1,t=0;t<this.GameBox.children.length-1;t++){var n=this.GameBox.children[t].position;if(n.y>=450){var o=new G;if(this.GameBox.children[t].getComponent(B).getLinearVelocityFromWorldPoint(this.node.worldPosition,o),o.y<=1&&o.y>-3){this.onGameOverCB();break}}n.y>=300&&(e=!0)}this.isShowLoseTip=e,this.ShowLoseTip.active=this.isShowLoseTip},a.update=function(e){this.onShowLoseTip()},t}(w)).prototype,"Card",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Z=t(j.prototype,"GameBox",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),X=t(j.prototype,"hcEff",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),V=j))||V));a._RF.pop()}}}));

System.register("chunks:///_virtual/HCGamePopUI.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Utility.ts","./clientEvent.ts","./EnumController.ts","./Entity.ts","./DynamicAssetManager.ts","./UIManager.ts","./UI.ts","./SGAD.ts"],(function(t){"use strict";var n,e,o,i,s,c,a,l,u,r,h,d,B,f;return{setters:[function(t){n=t.inheritsLoose},function(t){e=t.cclegacy,o=t._decorator,i=t.tween,s=t.Vec3,c=t.Node},function(t){a=t.default},function(t){l=t.clientEvent},function(t){u=t.HCGameEvent},function(t){r=t.UIType},function(t){h=t.AssetsIdName},function(t){d=t.default},function(t){B=t.default},function(t){f=t.default}],execute:function(){var p;e._RF.push({},"227afBWHitB55ychB/tTI1X","HCGamePopUI",void 0);var C=o.ccclass;o.property,t("HCGamePopUI",C("HCGamePopUI")(p=function(t){function e(){for(var n,e=arguments.length,o=new Array(e),i=0;i<e;i++)o[i]=arguments[i];return(n=t.call.apply(t,[this].concat(o))||this).BoxBg=null,n.Title=null,n.Icon=null,n.Describe=null,n.CloseBtn=null,n.VideoBtn=null,n.CompleteCardNum=void 0,n.showFishIndex=0,n}n(e,t);var o=e.prototype;return o.onLoad=function(){this.CompleteCardNum=parseInt(this.parm[0][0]),this.BoxBg=a.FindFunc(this.node,"BoxBg"),this.Title=a.FindFunc(this.node,"Title"),this.Icon=a.FindFunc(this.node,"Icon"),this.Describe=a.FindFunc(this.node,"Describe"),this.CloseBtn=a.FindFunc(this.node,"CloseBtn"),this.VideoBtn=a.FindFunc(this.node,"VideoBtn"),this.InitUI()},o.onEnable=function(){var t=this;i(this.BoxBg).to(.3,{scale:new s(1,1,1)}).call((function(){i(t.CloseBtn).to(.3,{scale:new s(1,1,1)}).call((function(){t.CloseBtn.on(c.EventType.TOUCH_END,t.CloseBtnCB,t)})).start()})).start()},o.onDisable=function(){},o.start=function(){},o.InitUI=function(){this.BoxBg.scale=new s(0,0),i(this.BoxBg).to(.3,{scale:new s(1,1)}).start()},o.VideoBtnCB=function(){var t=this;f.showVideoAd((function(){l.dispatchEvent(u.onFinishAgainGame),i(t.BoxBg).to(.1,{scale:new s(0,0,0)}).call((function(){d.GetInstance().closePopup(h.HCGameUI,r.HCGamePopUI)})).start()}),(function(){a.showToast("看完视频才能获得奖励哦！")}))},o.CloseBtnCB=function(){var t=this;i(this.BoxBg).to(.1,{scale:new s(0,0,0)}).call((function(){d.GetInstance().closePopup(h.HCGameUI,r.HCGamePopUI),d.GetInstance().openPopup(h.MainUI,r.OtherGameFinishPopUI,!0,[t.CompleteCardNum])})).start()},e}(B))||p);e._RF.pop()}}}));

System.register("chunks:///_virtual/MaJiang_CD_Logic.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Utility.ts","./DynamicAssetManager.ts","./SGAD.ts","./GameLogic.ts","./SoundMgr.ts","./UserGuide2.ts","./PlayerDataMgr.ts","./UIManager.ts","./Entity.ts"],(function(e){"use strict";var t,i,n,r,o,a,s,h,l,d,c,g,u,f,p,m,v,C,N,b,w,_,A,y,M,T,S,G;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,n=e.initializerDefineProperty,r=e.assertThisInitialized,o=e.createClass},function(e){a=e.cclegacy,s=e._decorator,h=e.Node,l=e.SpriteFrame,d=e.Sprite,c=e.find,g=e.instantiate,u=e.v3,f=e.UITransform,p=e.tween,m=e.Animation,v=e.Tween,C=e.Component},function(e){N=e.default},function(e){b=e.default,w=e.AssetsIdName},function(e){_=e.default},function(e){A=e.GameLogic},function(e){y=e.SoundMgr},function(e){M=e.UserGuide},function(e){T=e.default},function(e){S=e.default},function(e){G=e.UIType}],execute:function(){var J,I,k,O,D,P,j,B,E,x,U,W,H,z,F,L,R,Y,V,Z,q,K,Q,X,$,ee,te;a._RF.push({},"a7067ShCRZN3Zox4jgt9Nwd","MaJiang_CD_Logic",void 0);var ie=s.ccclass,ne=s.property;e("MaJiang_CD_Logic",(J=ie("MaJiang_CD_Logic"),I=ne(h),k=ne(h),O=ne(h),D=ne(h),P=ne(h),j=ne(h),B=ne(h),E=ne(h),x=ne(h),U=ne(h),W=ne(h),H=ne(h),J((L=t((F=function(e){function t(){for(var t,i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return t=e.call.apply(e,[this].concat(o))||this,n(t,"MJPrefab",L,r(t)),n(t,"DoubleMJPrefab",R,r(t)),n(t,"leftGrid",Y,r(t)),n(t,"rightGrid",V,r(t)),n(t,"downNode",Z,r(t)),n(t,"gridNode",q,r(t)),n(t,"combineNode",K,r(t)),n(t,"Effect_Chi",Q,r(t)),n(t,"Effect_Peng",X,r(t)),n(t,"block",$,r(t)),n(t,"changeTips",ee,r(t)),n(t,"loseTips",te,r(t)),t.TotalTypeArr=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34],t.targetArr=[],t.targetCount=10,t.gridCount=5,t.answerArr=[],t.mjWidth=72,t.mjHeight=102,t.mjSpaceY=95,t.isChanging=!1,t.changeArr=[],t.isNewer=!1,t.isGameOver=!1,t}i(t,e);var a=t.prototype;return a.onEnable=function(){var e=this,t=b.instance.getOneAsset(w.GameUI,"mj_pf_"+(T.getPlayerData().skinId_Use+1)+"_1",l);this.MJPrefab.getChildByName("bg").getComponent(d).spriteFrame=t;var i=b.instance.getOneAsset(w.GameUI,"mj_pf_"+(T.getPlayerData().skinId_Use+1)+"_3",l);this.DoubleMJPrefab.getComponent(d).spriteFrame=i,localStorage.getItem("CD_IsNewer")?(this.isNewer=!1,this.targetCount=135,this.gridCount=9):(this.isNewer=!0,this.targetCount=10,this.gridCount=5,this.scheduleOnce((function(){c("Canvas").getComponent(M).setGuideTextPos("follow"),c("Canvas").getComponent(M).setGuideTextBackgroundScale(1.4,1.4),c("Canvas").getComponent(M).setGuideTextFontSize(32),c("Canvas").getComponent(M).showGuideByGroup([6,7,8],(function(){e.isNewer=!1,e.combineNode.destroyAllChildren(),e.scheduleOnce((function(){e.downMJ()})),e.checkIsWin()&&e.gameOver(!0),e.checkIsLose()&&e.gameOver(!1),e.targetCount--}))}),.1)),this.initTarget(),this.initGrid(),this.leftGrid.children[0].getChildByName("lock").on(h.EventType.TOUCH_END,(function(){y._ins.PlaySound("MaJiang_HH_Select"),_.showVideoAd((function(){e.leftGrid.children[0].getChildByName("lock").destroy(),e.isGameOver=!1}))}),this),this.rightGrid.children[0].getChildByName("lock").on(h.EventType.TOUCH_END,(function(){y._ins.PlaySound("MaJiang_HH_Select"),_.showVideoAd((function(){e.rightGrid.children[0].getChildByName("lock").destroy(),e.isGameOver=!1}))}),this)},a.getNewDoubleMJ=function(e){var t=g(this.DoubleMJPrefab);return t.name=e.toString(),t.getChildByName("mj1").getComponent(d).spriteFrame=this.getMJSpriteFrame(e[0]),t.getChildByName("mj2").getComponent(d).spriteFrame=this.getMJSpriteFrame(e[1]),t},a.getNewMJ=function(e){var t=g(this.MJPrefab);return t.name=e.toString(),t.getChildByName("bg").getChildByName("mj").getComponent(d).spriteFrame=this.getMJSpriteFrame(e),t},a.getMJSpriteFrame=function(e){var t="";return e<=9?t="mj_w_0"+e:e>9&&e<=18?t="mj_b_0"+(e-9):e>18&&e<=27?t="mj_t_0"+(e-18):e>27&&e<=34?(28==e&&(t="mj_o_0d"),29==e&&(t="mj_o_0n"),30==e&&(t="mj_o_0x"),31==e&&(t="mj_o_0b"),32==e&&(t="mj_o_0z"),33==e&&(t="mj_o_0f"),34==e&&(t="mj_o_0w")):35==e&&(t="mj_l_0-1"),b.instance.getOneAsset(w.GameUI,t,l)},a.initTarget=function(){for(var e=0;e<this.targetCount;e++)if(Math.random()<.5){var t=N.getRandomItemInArr(this.TotalTypeArr);this.targetArr.push([t])}else{var i=[].concat(this.TotalTypeArr);i.splice(26,8);var n=N.getRandomItemInArr(i);9==n||18==n||27==n?this.targetArr.push([n-1,n]):this.targetArr.push([n,n+1])}this.isNewer&&(this.targetArr[0]=[10,11]);for(var r=0;r<this.targetArr.length;r++){var o=this.targetArr[r];1==o.length?this.answerArr.push(o[0]):1==o[0]?this.answerArr.push(3):9==o[1]?this.answerArr.push(7):10==o[0]?this.answerArr.push(12):18==o[1]?this.answerArr.push(16):19==o[0]?this.answerArr.push(21):27==o[1]?this.answerArr.push(25):Math.random()<.5?this.answerArr.push(o[0]-1):this.answerArr.push(o[1]+1)}this.createDownMJ()},a.createDownMJ=function(){for(var e=0;e<this.targetArr.length;e++){var t=this.getNewDoubleMJ(1==this.targetArr[e].length?[this.targetArr[e][0],this.targetArr[e][0]]:[this.targetArr[e][0],this.targetArr[e][1]]);this.downNode.insertChild(t,0),t.position=u(0,e*this.mjSpaceY)}},a.initGrid=function(){for(var e=0;e<this.gridCount;e++){var t=new h("mjNode"+e);t.addComponent(f),this.gridNode.addChild(t),t.position=u(Math.floor(this.gridCount/2)*-this.mjWidth+e*this.mjWidth,0)}this.createGridMJ()},a.createGridMJ=function(){var e=this;if(this.isNewer)for(var t=0;t<this.gridNode.children.length;t++)for(var i=this.gridNode.children[t],n=function(){var t=e.answerArr.shift(),n=e.getNewMJ(t);i.addChild(n),n.position=u(0,-e.mjSpaceY*r),n.on(h.EventType.TOUCH_END,(function(){e.clickMJ(n)}),e)},r=0;r<Math.floor(this.targetCount/this.gridCount);r++)n();else{var o=this.answerArr.slice(0,2*this.gridCount);o=N.shuffleArr(o);var a=0,s=function(){var t=e.gridNode.children[a],i=o.shift(),n=e.getNewMJ(i);t.addChild(n);var r=n.getSiblingIndex();n.position=u(0,-e.mjSpaceY*r),n.on(h.EventType.TOUCH_END,(function(){e.clickMJ(n)}),e),++a>=e.gridCount&&(a=0),o.length>0&&s()};s(),o=this.answerArr.slice(2*this.gridCount,4*this.gridCount),o=N.shuffleArr(o),a=0,(s=function(){var t=e.gridNode.children[a],i=o.shift(),n=e.getNewMJ(i);t.addChild(n);var r=n.getSiblingIndex();n.position=u(0,-e.mjSpaceY*r),n.on(h.EventType.TOUCH_END,(function(){e.clickMJ(n)}),e),++a>=e.gridCount&&(a=0),o.length>0&&s()})(),o=this.answerArr.slice(4*this.gridCount,6*this.gridCount),o=N.shuffleArr(o),a=0,(s=function(){var t=e.gridNode.children[a],i=o.shift(),n=e.getNewMJ(i);t.addChild(n);var r=n.getSiblingIndex();n.position=u(0,-e.mjSpaceY*r),n.on(h.EventType.TOUCH_END,(function(){e.clickMJ(n)}),e),++a>=e.gridCount&&(a=0),o.length>0&&s()})(),o=this.answerArr.slice(6*this.gridCount,this.answerArr.length),o=N.shuffleArr(o),a=0,(s=function(){var t=e.gridNode.children[a],i=o.shift(),n=e.getNewMJ(i);t.addChild(n);var r=n.getSiblingIndex();n.position=u(0,-e.mjSpaceY*r),n.on(h.EventType.TOUCH_END,(function(){e.clickMJ(n)}),e),++a>=e.gridCount&&(a=0),o.length>0&&s()})()}},a.clickMJ=function(e){var t=this;if(y._ins.PlaySound("MaJiang_HH_Select"),N.DoVibrate(),this.isChanging){if(this.changeArr.length>=2)return;if(e.parent&&e.parent.parent&&("leftGrid"==e.parent.parent.name||"rightGrid"==e.parent.parent.name))return;if(-1!=this.changeArr.indexOf(e))return;return p(e).to(.25,{scale:u(1.1,1.1,1)}).to(.25,{scale:u(1,1,1)}).union().repeatForever().start(),this.changeArr.push(e),void(this.changeArr.length>=2&&this.changeMJ())}if(e.getSiblingIndex()>0)return console.log("不是第一排"),N.showToast("只能点击第一排的麻将"),this.shakeNode(e.getChildByName("bg")),void y._ins.PlaySound("MaJiang_CD_Wrong");var i=e.name,n=parseInt(i);if(-1!=this.curTargetAnswer.indexOf(n))this.combineCB(e);else{if(null==this.getSideGrid()||e.parent&&e.parent.parent&&("leftGrid"==e.parent.parent.name||"rightGrid"==e.parent.parent.name))return this.shakeNode(e.getChildByName("bg")),void y._ins.PlaySound("MaJiang_CD_Wrong");this.setToSideGrid(e),this.scheduleOnce((function(){t.checkIsLose()&&t.gameOver(!1)}))}},a.setToSideGrid=function(e){var t=this,i=e.parent.getSiblingIndex(),n=this.getSideGrid(),r=N.getWorldPos(e);n.addChild(e),e.setPosition(n.getComponent(f).convertToNodeSpaceAR(r)),p(e).to(.1,{position:u()}).call((function(){})).start(),this.scheduleOnce((function(){t.fullTheGrid(i)}))},a.getSideGrid=function(){for(var e=0;e<this.leftGrid.children.length;e++){var t=this.leftGrid.children[e];if(!(t.children.length>0))return t}for(var i=0;i<this.rightGrid.children.length;i++){var n=this.rightGrid.children[i];if(!(n.children.length>0))return n}return null},a.combineCB=function(e){var t=this;this.isGameOver=!1,1==this.curTargetAnswer.length?(y._ins.PlaySound("MaJiang_CD_Peng"),this.Effect_Peng.getComponent(m).play()):(y._ins.PlaySound("MaJiang_CD_Chi"),this.Effect_Chi.getComponent(m).play());var i=e.parent.getSiblingIndex();v.stopAllByTarget(this.combineNode),this.combineNode.destroyAllChildren(),this.isNewer||p(this.combineNode).delay(.5).call((function(){t.combineNode.destroyAllChildren()})).start();var n=N.getWorldPos(e);this.combineNode.addChild(e),e.position=this.combineNode.getComponent(f).convertToNodeSpaceAR(n);var r=u(-this.mjWidth,0);p(e).to(.1,{position:r}).call((function(){})).start();var o=this.downNode.children[this.downNode.children.length-1],a=N.getWorldPos(o);this.combineNode.addChild(o),o.position=this.combineNode.getComponent(f).convertToNodeSpaceAR(a);var s=u(this.mjWidth/2,0);p(o).to(.1,{position:s}).call((function(){})).start(),this.isNewer?this.scheduleOnce((function(){t.fullTheGrid(i)})):(this.scheduleOnce((function(){t.downMJ(),t.fullTheGrid(i)})),this.checkIsWin()&&this.gameOver(!0),this.checkIsLose()&&this.gameOver(!1),this.targetCount--)},a.downMJ=function(){if(!(this.downNode.children.length<=0))for(var e=this.downNode.children.length-1;e>=0;e--){var t=this.downNode.children[e],i=u(0,(this.downNode.children.length-1-e)*this.mjSpaceY);p(t).to(.1,{position:i}).call((function(){})).start()}},a.fullTheGrid=function(e){var t=this.gridNode.children[e];if(!(t.children.length<=0)&&0!=t.children[0].position.y)for(var i=0;i<t.children.length;i++){var n=u(0,-this.mjSpaceY*i);p(t.children[i]).to(.05,{position:n}).call((function(){})).start()}},a.checkIsWin=function(){return this.downNode.children.length<=0},a.checkIsLose=function(){for(var e=!1,t=0;t<this.gridNode.children.length;t++){var i=this.gridNode.children[t];if(!(i.children.length<=0)&&-1!=this.curTargetAnswer.indexOf(parseInt(i.children[0].name))){e=!0;break}}for(var n=!0,r=0;r<this.leftGrid.children.length;r++){if(this.leftGrid.children[r].children.length<=0){n=!1;break}if(-1!=this.curTargetAnswer.indexOf(parseInt(this.leftGrid.children[r].children[0].name))){n=!1;break}}for(var o=!0,a=0;a<this.rightGrid.children.length;a++){if(this.rightGrid.children[a].children.length<=0){o=!1;break}if(-1!=this.curTargetAnswer.indexOf(parseInt(this.rightGrid.children[a].children[0].name))){o=!1;break}}if(n&&o&&!e)return!0;for(var s=!0,h=0;h<this.gridNode.children.length;h++){if(this.gridNode.children[h].children.length>0){s=!1;break}}if(s){for(var l=!1,d=!1,c=0;c<this.leftGrid.children.length;c++){var g=this.leftGrid.children[c];if(!(g.getChildByName("lock")||g.children.length<=0)&&-1!=this.curTargetAnswer.indexOf(parseInt(g.children[0].name))){l=!0;break}}for(var u=0;u<this.rightGrid.children.length;u++){var f=this.rightGrid.children[u];if(!(f.getChildByName("lock")||f.children.length<=0)&&-1!=this.curTargetAnswer.indexOf(parseInt(f.children[0].name))){d=!0;break}}if(!l&&!d)return!0}return!1},a.gameOver=function(e){var t=this;this.isGameOver||(this.isGameOver=!0,console.log(e?"胜利":"失败"),e?(y._ins.PlaySound("MaJiang_HH_Complete"),localStorage.getItem("CD_IsNewer")?(this.block.active=!0,A.Share.onOtherGameFinishPopUI([N.GetRandom(40,100)])):(localStorage.setItem("CD_IsNewer","1"),this.scheduleOnce((function(){t.restartCB()}),2))):(this.loseTips.active=!0,this.scheduleOnce((function(){t.loseTips.isValid&&(t.loseTips.active=!1)}),5)))},a.resetCB=function(){var e=this;this.getGridMJCount<=0||_.showVideoAd((function(){e.block.active=!0;for(var t=[],i=0;i<e.gridNode.children.length;i++)for(var n=e.gridNode.children[i],r=0;r<n.children.length;r++){var o=n.children[r];t.push(o)}if(!(t.length<=0)){t=N.shuffleArr(t);var a=0;!function i(){var n=e.gridNode.children[a],r=t.pop();n.addChild(r),++a>=e.gridCount&&(a=0),t.length>0&&i()}();for(var s=0;s<e.gridNode.children.length;s++)for(var h=e.gridNode.children[s],l=0;l<h.children.length;l++)p(h.children[l]).to(.2,{position:u(0,-e.mjSpaceY*l)}).start();e.scheduleOnce((function(){e.block.active=!1}),.3)}}))},a.changeCB=function(){var e=this;this.getGridMJCount<2?N.showToast("可以交换麻将少于2个"):_.showVideoAd((function(){e.isChanging=!0,e.changeTips.active=!0}))},a.changeMJ=function(){var e=this.changeArr[0],t=this.changeArr[1];v.stopAllByTarget(e),v.stopAllByTarget(t),e.scale=u(1,1,1),t.scale=u(1,1,1);var i=e.getSiblingIndex(),n=t.getSiblingIndex(),r=e.parent,o=t.parent,a=e.position.clone(),s=t.position.clone(),h=N.getWorldPos(e),l=N.getWorldPos(t);r.removeChild(e),o.removeChild(t),r.insertChild(t,i),o.insertChild(e,n),e.position=o.getComponent(f).convertToNodeSpaceAR(h),t.position=r.getComponent(f).convertToNodeSpaceAR(l),p(e).to(.2,{position:s}).start(),p(t).to(.2,{position:a}).start(),this.changeArr=[],this.isChanging=!1,this.changeTips.active=!1},a.allCB=function(){var e=this;this.downNode.children.length<=0||_.showVideoAd((function(){e.combineNode.destroyAllChildren(),1==e.curTargetAnswer.length?(y._ins.PlaySound("MaJiang_CD_Peng"),e.Effect_Peng.getComponent(m).play()):(y._ins.PlaySound("MaJiang_CD_Chi"),e.Effect_Chi.getComponent(m).play());var t=u(550,100),i=e.getNewMJ(35);e.combineNode.addChild(i),i.position=e.combineNode.getComponent(f).convertToNodeSpaceAR(t);var n=u(-e.mjWidth,0);p(i).to(.1,{position:n}).call((function(){})).start();var r=e.downNode.children[e.downNode.children.length-1],o=N.getWorldPos(r);e.combineNode.addChild(r),r.position=e.combineNode.getComponent(f).convertToNodeSpaceAR(o);var a=u(e.mjWidth/2,0);p(r).to(.1,{position:a}).call((function(){})).start(),e.scheduleOnce((function(){i.isValid&&i.destroy(),r.isValid&&r.destroy()}),.5),e.scheduleOnce((function(){e.downMJ()})),e.checkIsWin()&&e.gameOver(!0),e.checkIsLose()&&e.gameOver(!1),e.targetCount--}))},a.update=function(e){},a.restartCB=function(){this.node.destroy(),S.GetInstance().closePage(w.MaJiang_CD,G.MaJiang_CD),A.Share.gameStart_CD()},a.shakeNode=function(e,t,i,n){void 0===t&&(t=3),void 0===i&&(i=.15),void 0===n&&(n=4),v.stopAllByTarget(e),e.position=u();var r=0,o=e.position.clone();!function a(){var s=u(Math.random()*(2*t)-t+o.x,Math.random()*(2*t)-t+o.y);p(e).to(i/n,{position:s}).call((function(){++r<n?a():e.position=o})).start()}()},o(t,[{key:"curTargetAnswer",get:function(){if(this.downNode.children.length<=0)return[];var e=this.downNode.children[this.downNode.children.length-1].name.split(",");return e[0]==e[1]?[parseInt(e[0])]:[parseInt(e[0])-1,parseInt(e[1])+1]}},{key:"getGridMJCount",get:function(){for(var e=0,t=0;t<this.gridNode.children.length;t++){e+=this.gridNode.children[t].children.length}return e}}]),t}(C)).prototype,"MJPrefab",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=t(F.prototype,"DoubleMJPrefab",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Y=t(F.prototype,"leftGrid",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=t(F.prototype,"rightGrid",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Z=t(F.prototype,"downNode",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=t(F.prototype,"gridNode",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=t(F.prototype,"combineNode",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Q=t(F.prototype,"Effect_Chi",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),X=t(F.prototype,"Effect_Peng",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),$=t(F.prototype,"block",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ee=t(F.prototype,"changeTips",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),te=t(F.prototype,"loseTips",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=F))||z));a._RF.pop()}}}));

System.register("chunks:///_virtual/MaJiang_CD_UI.ts",["./rollupPluginModLoBabelHelpers.js","cc","./MaJiang_CD_Logic.ts","./GameLogic.ts"],(function(t){"use strict";var i,n,e,o,a,r,c,l,g,s,u;return{setters:[function(t){i=t.applyDecoratedDescriptor,n=t.inheritsLoose,e=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){a=t.cclegacy,r=t._decorator,c=t.Node,l=t.Label,g=t.Component},function(t){s=t.MaJiang_CD_Logic},function(t){u=t.GameLogic}],execute:function(){var _,h,p,f,C,b,m;a._RF.push({},"95aa2f27tFF9pOh7tyBsSvP","MaJiang_CD_UI",void 0);var d=r.ccclass,y=r.property;t("MaJiang_CD_UI",(_=d("MaJiang_CD_UI"),h=y(c),p=y(l),_((b=i((C=function(t){function i(){for(var i,n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return(i=t.call.apply(t,[this].concat(a))||this)._logic=null,e(i,"title",b,o(i)),e(i,"targetNum",m,o(i)),i}n(i,t);var a=i.prototype;return a.onLoad=function(){this._logic=this.node.parent.getComponent(s)},a.onEnable=function(){this.title.children[0].active=!localStorage.getItem("CD_IsNewer"),this.title.children[1].active="1"==localStorage.getItem("CD_IsNewer")},a.btn_pauseCB=function(){this._logic.isChanging||u.Share.onShowSetPopUI()},a.btn_resetCB=function(){this._logic.isChanging||this._logic.resetCB()},a.btn_changeCB=function(){this._logic.isChanging||this._logic.changeCB()},a.btn_allCB=function(){this._logic.isChanging||this._logic.allCB()},a.update=function(t){this.targetNum.string=this._logic.targetCount.toString()},i}(g)).prototype,"title",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),m=i(C.prototype,"targetNum",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),f=C))||f));a._RF.pop()}}}));

System.register("chunks:///_virtual/MaJiang_HH_Logic.ts",["./rollupPluginModLoBabelHelpers.js","cc","./DynamicAssetManager.ts","./Utility.ts","./SGAD.ts","./MaJiang_HH_UI.ts","./SoundMgr.ts","./UserGuide2.ts","./PlayerDataMgr.ts","./GameLogic.ts"],(function(e){"use strict";var t,i,r,n,o,a,h,l,c,s,d,u,g,f,p,m,v,N,y,b,C,w,G,A,_,k,M,j;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,r=e.initializerDefineProperty,n=e.assertThisInitialized,o=e.createClass},function(e){a=e.cclegacy,h=e._decorator,l=e.Node,c=e.SpriteFrame,s=e.Sprite,d=e.find,u=e.instantiate,g=e.UIOpacity,f=e.Vec3,p=e.tween,m=e.v3,v=e.UITransform,N=e.Animation,y=e.Component},function(e){b=e.default,C=e.AssetsIdName},function(e){w=e.default},function(e){G=e.default},function(e){A=e.MaJiang_HH_UI},function(e){_=e.SoundMgr},function(e){k=e.UserGuide},function(e){M=e.default},function(e){j=e.GameLogic}],execute:function(){var S,B,D,I,P,T,J,H,x,F,O,U,Y,z,R,V,L;a._RF.push({},"50e114lq1tAVoaaSD+VNxGr","MaJiang_HH_Logic",void 0);var X=h.ccclass,E=h.property;e("MaJiang_HH_Logic",(S=X("MaJiang_HH_Logic"),B=E(l),D=E(l),I=E(l),P=E(l),T=E(l),J=E(l),H=E(l),S((O=t((F=function(e){function t(){for(var t,i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return(t=e.call.apply(e,[this].concat(o))||this)._ui=null,r(t,"MJPrefab",O,n(t)),r(t,"fullPrefab",U,n(t)),r(t,"destroyPTPrefab",Y,n(t)),r(t,"downPTPrefab",z,n(t)),r(t,"DownNode",R,n(t)),r(t,"GridNode",V,n(t)),r(t,"block",L,n(t)),t.combineFX=null,t.TotalTypeArr=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27],t.targetArr=[],t.baseTarget=0,t.curTarget=0,t.unlockGridArr=[0,1,1,1,1,1,0,0,0,0],t.mjSpaceY=88.5,t.mjUpY=10,t.newGridMjPosY=760,t.upingGridIndex=-1,t.upingMjArr=[],t.downMJRandArr=[[.5,.5],[.4,.45,.05],[.4,.35,.2,.05],[.3,.3,.3,.05,.05],[.3,.3,.2,.1,.05,.05],[.1,.2,.2,.2,.2,.075,.025],[.1,.2,.2,.2,.1,.1,.075,.025],[.1,.1,.1,.2,.2,.1,.1,.075,.025]],t.isWin=!1,t.isNewer=!1,t}i(t,e);var a=t.prototype;return a.onLoad=function(){this.combineFX=this.node.getChildByName("Game").getChildByName("combineFX")},a.start=function(){},a.onEnable=function(){var e=this;this.isNewer=!localStorage.getItem("HH_IsNewer"),localStorage.setItem("HH_IsNewer","1");var t=b.instance.getOneAsset(C.GameUI,"mj_pf_"+(M.getPlayerData().skinId_Use+1)+"_1",c);this.MJPrefab.getChildByName("bg").getComponent(s).spriteFrame=t,this.isNewer&&this.scheduleOnce((function(){d("Canvas").getComponent(k).setGuideTextPos("follow"),d("Canvas").getComponent(k).setGuideTextBackgroundScale(1.2,1.2),d("Canvas").getComponent(k).setGuideTextFontSize(30),d("Canvas").getComponent(k).showGuideByGroup([1,2,3,4])}),.1),this._ui=this.getComponentInChildren(A),this.initTargetArr(),this.createDownMJ();for(var i=function(t){var i=e.GridNode.children[t];i.on(l.EventType.TOUCH_END,(function(){e.clickGrid(t)}),e);var r=u(e.fullPrefab);if(r.name="full",r.position=m(0,10),i.addChild(r),e.isNewer&&2==t)for(var n=0;n<5;n++){var o=e.getNewMJ(e.curTarget);i.getChildByName("mjNode").insertChild(o,0);var a=new f(0,o.getComponent(v).height/2+e.mjSpaceY*n);o.position=a}},r=0;r<this.GridNode.children.length;r++)i(r)},a.getNewMJ=function(e){var t=u(this.MJPrefab);return t.name=e.toString(),t.getChildByName("mj").getComponent(s).spriteFrame=this.getMJSpriteFrame(e),t},a.getMJSpriteFrame=function(e){var t="";return e<=9?t="mj_w_0"+e:e>9&&e<=18?t="mj_b_0"+(e-9):e>18&&e<=27&&(t="mj_t_0"+(e-18)),b.instance.getOneAsset(C.GameUI,t,c)},a.initTargetArr=function(){this.targetArr.push(w.GetRandom(3,20)),this.targetArr.push(this.targetArr[0]+1),this.targetArr.push(this.targetArr[1]+3),this.targetArr.push(this.targetArr[2]+1),this.targetArr.push(this.targetArr[3]+2),this.baseTarget=this.targetArr[0]-2,this.curTarget=this.targetArr[0]-1,this._ui.initTargetArr(this.targetArr)},a.getDownMJIndex=function(){if(this.isNewer)return this.curTarget;for(var e=1*Math.random(),t=this.curTarget-this.baseTarget-1,i=this.downMJRandArr[t],r=0,n=0;n<i.length;n++){if(e<=(r+=i[n]))return this.baseTarget+n}return this.baseTarget},a.sortNodeIndex=function(e,t){void 0===t&&(t=!1);for(var i=0;i<e.children.length;i++){var r=e.children[i];r.getComponent(g).opacity=t?200-50*i:255}e.children.sort((function(e,t){return t.position.y-e.position.y}))},a.resetNodeIndex=function(e){e.children.sort((function(e,t){return e.position.y-t.position.y}))},a.createDownMJ=function(){for(var e=this.getUnlockGridCount,t=w.GetRandom(e-3,e),i=[],r=0;r<this.unlockGridArr.length;r++)1==this.unlockGridArr[r]&&this.GridNode.children[r].getChildByName("mjNode").children.length<8&&i.push(r);(i=w.getRandomItemInArrWithoutSelf(-1,i,t)).length<=0&&!this.checkCanCombine()&&(this._ui.node.getChildByName("loseTips").active=!0),this.isNewer&&(i=[1]);for(var n=0;n<this.DownNode.children.length;n++){var o=this.DownNode.children[n],a=o.getChildByName("bg"),h=o.getChildByName("mjNode");if(0!=this.unlockGridArr[n]&&-1!=i.indexOf(n)){a.active=!0,h.active=!0;for(var l=0;l<3;l++){var c=w.GetRandom(1,4),d=!1;if(0==l&&c<=4&&(d=!0),1==l&&c<=2&&(d=!0),2==l&&c<=1&&(d=!0),this.isNewer&&(d=!0),!d)break;var p=u(this.MJPrefab);h.insertChild(p,0),p.getComponent(g).opacity=200-50*l,p.position=new f(0,l*this.mjSpaceY);var m=this.getDownMJIndex();p.getChildByName("mj").getComponent(s).spriteFrame=this.getMJSpriteFrame(m),p.name=m.toString()}}else a.active=!1,h.active=!1}},a.btnDownCB=function(){var e=this;this.block.active=!0;for(var t=0,i=0,r=function(){var r=e.DownNode.children[n],o=r.getChildByName("mjNode"),a=r.getChildByName("bg");if(0==o.active)return"continue";e.resetNodeIndex(o);for(var h=e.GridNode.children[n],l=h.getChildByName("mjNode"),c=l.children.length,s=8-c,d=function(){if(u>=s)return"continue";t++;var r=o.children[u],n=w.getWorldPos(r),a=e.getNewMJ(parseInt(r.name)),d=l.getComponent(v).convertToNodeSpaceAR(n);a.position=d,l.insertChild(a,0);var g=new f(0,a.getComponent(v).height/2+e.mjSpaceY*(u+c));p(a).delay(.1*u).to(.2,{position:g}).call((function(){e.createDownPT(h,g),_._ins.PlaySound("MaJiang_HH_Down"),w.DoVibrate(),++i>=t&&(e.createDownMJ(),e.block.active=!1,e.checkIsShowBtnSort()&&(e._ui.btn_combine.getChildByName("btn_sort").active=!0))})).start()},u=0;u<o.children.length;u++)d();o.destroyAllChildren(),o.active=!1,a.active=!1},n=0;n<this.DownNode.children.length;n++)r();t<=0&&(this.createDownMJ(),this.block.active=!1,this.checkIsShowBtnSort()&&(this._ui.btn_combine.getChildByName("btn_sort").active=!0))},a.checkIsShowBtnSort=function(){for(var e=0,t=0;t<this.unlockGridArr.length;t++)1==this.unlockGridArr[t]&&e++;for(var i=0,r=0;r<this.GridNode.children.length;r++){this.GridNode.children[r].getChildByName("mjNode").children.length>=4&&i++}return i>=e-1},a.clickGrid=function(e){var t=this;if(0!=e||0!=this.unlockGridArr[0])if(0!=this.unlockGridArr[e])if(this._ui.resetShowDownTips(),this.upingGridIndex!=e){var i=this.GridNode.children[e].getChildByName("mjNode");if(!(-1==this.upingGridIndex&&i.children.length<=0))if(-1==this.upingGridIndex){_._ins.PlaySound("MaJiang_HH_Select");for(var r=-1,n=0;n<i.children.length;n++){var o=i.children[n],a=o.name,h=parseInt(a);if(-1==r&&(r=h),h!=r)break;this.upingMjArr.push(o)}this.upingGridIndex=e;for(var l=0;l<this.upingMjArr.length;l++){var c=this.upingMjArr[l];c.position=m(0,c.position.y+this.mjUpY)}}else{this.block.active=!0;var s=0,d=0,u=this.GridNode.children[e],N=u.getChildByName("mjNode");if(N.children.length>0&&parseInt(this.upingMjArr[0].name)!=parseInt(N.children[0].name))return this.putDownMj(),void(this.block.active=!1);for(var y=N.children.length,b=8-y,C=function(){if(A>=b){for(var e=t.upingMjArr.splice(A,t.upingMjArr.length-A),i=0;i<e.length;i++)e[i].position=m(0,e[i].position.y-t.mjUpY);return"break"}s++;var r=t.upingMjArr[A],n=parseInt(r.name),o=t.getNewMJ(n);N.insertChild(o,0),o.position=m(0,t.newGridMjPosY);var a=new f(0,o.getComponent(v).height/2+t.mjSpaceY*(A+y));p(o).delay(.05*A).to(.05,{position:a}).call((function(){_._ins.PlaySound("MaJiang_HH_Down"),w.DoVibrate(),t.createDownPT(u,a),++d>=s&&(t.block.active=!1)})).start()},A=0;A<this.upingMjArr.length;A++){if("break"===C())break}this.upingGridIndex=-1;for(var k=this.upingMjArr.length-1;k>=0;k--)this.upingMjArr[k].destroy();this.upingMjArr=[],s<=0&&(this.block.active=!1)}}else this.putDownMj();else this.GridNode.children[e].getChildByName("lock2").active&&(_._ins.PlaySound("MaJiang_HH_Complete"),this.unlockGridArr[e]=1,p(this.GridNode.children[e].getChildByName("lock2")).to(.2,{scale:m(1.2,1.2,1)}).call((function(){t.GridNode.children[e].getChildByName("lock2").active=!1})).start(),p(this.GridNode.children[e].getChildByName("lock2").getComponent(g)).to(.2,{opacity:0}).start());else G.showVideoAd((function(){t.unlockGridArr[0]=1,t.GridNode.children[0].getChildByName("sp").destroy()}))},a.putDownMj=function(){if(-1!=this.upingGridIndex){_._ins.PlaySound("MaJiang_HH_Down"),this.upingGridIndex=-1;for(var e=0;e<this.upingMjArr.length;e++){var t=this.upingMjArr[e];t.position=m(0,t.position.y-this.mjUpY)}this.upingMjArr=[]}},a.checkCanCombine=function(){for(var e=0;e<this.GridNode.children.length;e++)if(0!=this.unlockGridArr[e]){var t=!0,i=this.GridNode.children[e].getChildByName("mjNode"),r=-1;if(i.children.length>=8)for(var n=0;n<i.children.length;n++){var o=parseInt(i.children[n].name);-1==r&&(r=o),r!=o&&(t=!1)}else t=!1;if(t)return!0}return!1},a.btnCombineCB=function(){var e=this;_._ins.PlaySound("MaJiang_HH_Combine");var t=0,i=0,r=0;this.putDownMj();for(var n=function(){if(0==e.unlockGridArr[o])return"continue";var n=e.GridNode.children[o],a=n.getChildByName("mjNode"),h=!0,l=-1;if(a.children.length>=8)for(var c=0;c<a.children.length;c++){var s=parseInt(a.children[c].name);-1==l&&(l=s),l!=s&&(h=!1)}else h=!1;if(!h)return"continue";r++,e.block.active=!0;for(var u=[],g=0;g<a.children.length;g++){var p=a.children[g];u.push(p)}t+=u.length;var m=0,N=u.length;u.forEach((function(r){e.scheduleOnce((function(){e.isNewer&&(d("Canvas").getComponent(k).setGuideTextPos("center"),d("Canvas").getComponent(k).setGuideTextBackgroundScale(1.5,1.5),d("Canvas").getComponent(k).showGuide(5,!1,(function(){e.isNewer=!1}))),w.DoVibrate(),e.createDestroyPT(n,r.position),e.scheduleOnce((function(){var n=parseInt(r.name);if(r.destroy(),i++,++m>=N){for(var o=0;o<2;o++){var h=e.getNewMJ(n+1);a.insertChild(h,0);var l=new f(0,h.getComponent(v).height/2+e.mjSpaceY*o);h.position=l}e._ui.createNewTarget(n+1),e.unlockGrid(n+1)}if(i>=t){if(n+1>=e.targetArr[e.targetArr.length-1])return e.isWin=!0,e.block.active=!0,void j.Share.onOtherGameFinishPopUI([w.GetRandom(40,100)]);e.block.active=!1,e.checkHaveDownMJ()||e.scheduleOnce((function(){e.createDownMJ()}))}}),.2)}),.05*u.indexOf(r))}))},o=0;o<this.GridNode.children.length;o++)n();this.showCombineFX(r),this._ui.btn_combine.getChildByName("btn_sort").active=!1},a.btnSortCB=function(){var e=this;this.putDownMj(),G.showVideoAd((function(){e._ui.node.getChildByName("loseTips").active=!1;for(var t={},i=0;i<e.GridNode.children.length;i++){var r=e.GridNode.children[i].getChildByName("mjNode");if(!(0==e.unlockGridArr[i]||r.children.length<=0)){for(var n=0;n<r.children.length;n++){var o=r.children[n],a=parseInt(o.name);t.hasOwnProperty(a.toString())?t[a.toString()]=t[a.toString()]+1:t[a.toString()]=1}r.destroyAllChildren()}}Object.keys(t).length;for(var h=0,l=0;l<e.unlockGridArr.length;l++)if(0!=e.unlockGridArr[l]){for(var c=e.GridNode.children[l].getChildByName("mjNode"),s=parseInt(Object.keys(t)[h]),d=0;d<t[s.toString()]&&!(d>=8);d++){var u=e.getNewMJ(parseInt(s.toString()));c.insertChild(u,0);var g=new f(0,u.getComponent(v).height/2+e.mjSpaceY*d);u.position=g}h++}e.checkHaveDownMJ()||e.scheduleOnce((function(){e.createDownMJ()})),e._ui.btn_combine.getChildByName("btn_sort").active=!1}))},a.unlockGrid=function(e){if(-1!=this._ui.unlockNewGridArr.indexOf(e)){this._ui.unlockNewGridArr.shift();for(var t=6;t<this.unlockGridArr.length;t++)if(0==this.unlockGridArr[t]){this.GridNode.children[t].getChildByName("lock1").active=!1,this.GridNode.children[t].getChildByName("lock2").active=!0;break}}},a.createDestroyPT=function(e,t){t.y-=354;var i=u(this.destroyPTPrefab);e.addChild(i),i.active=!0,i.position=t,this.scheduleOnce((function(){i.isValid&&i.destroy()}),1)},a.createDownPT=function(e,t){t.y-=354+this.mjSpaceY/2;var i=u(this.downPTPrefab);e.addChild(i),i.active=!0,i.position=t,this.scheduleOnce((function(){i.isValid&&i.destroy()}),1)},a.checkHaveDownMJ=function(){for(var e=0,t=0;t<this.DownNode.children.length;t++){e+=this.DownNode.children[t].getChildByName("mjNode").children.length}return e>0},a.showCombineFX=function(e){if(!(e<2)){this.combineFX.getComponent(N).play();for(var t=this.combineFX.getChildByName("txtNode"),i=0;i<t.children.length;i++)t.children[i].active=i==e-2;e>5&&(t.children[3].active=!0)}},a.update=function(e){for(var t=0;t<this.GridNode.children.length;t++)if(0!=this.unlockGridArr[t]){var i=!0,r=this.GridNode.children[t],n=r.getChildByName("mjNode"),o=-1;if(n.children.length>=8)for(var a=0;a<n.children.length;a++){var h=parseInt(n.children[a].name);-1==o&&(o=h),o!=h&&(i=!1)}else i=!1;r.getChildByName("full").active=i}},o(t,[{key:"getUnlockGridCount",get:function(){for(var e=0,t=0;t<this.unlockGridArr.length;t++)1==this.unlockGridArr[t]&&e++;return e}}]),t}(y)).prototype,"MJPrefab",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=t(F.prototype,"fullPrefab",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Y=t(F.prototype,"destroyPTPrefab",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=t(F.prototype,"downPTPrefab",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=t(F.prototype,"DownNode",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=t(F.prototype,"GridNode",[J],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=t(F.prototype,"block",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=F))||x));a._RF.pop()}}}));

System.register("chunks:///_virtual/MaJiang_HH_UI.ts",["./rollupPluginModLoBabelHelpers.js","cc","./MaJiang_HH_Logic.ts","./DynamicAssetManager.ts","./MyButton.ts","./Utility.ts","./PlayerDataMgr.ts","./GameLogic.ts"],(function(t){"use strict";var e,i,n,r,o,a,s,c,l,g,u,h,p,m,d,f,b,_,w,C,y,N,B,T;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,n=t.initializerDefineProperty,r=t.assertThisInitialized},function(t){o=t.cclegacy,a=t._decorator,s=t.Sprite,c=t.Node,l=t.SpriteFrame,g=t.Animation,u=t.ProgressBar,h=t.Label,p=t.instantiate,m=t.v3,d=t.UITransform,f=t.tween,b=t.Component},function(t){_=t.MaJiang_HH_Logic},function(t){w=t.default,C=t.AssetsIdName},function(t){y=t.MyButton},function(t){N=t.default},function(t){B=t.default},function(t){T=t.GameLogic}],execute:function(){var v,A,S,M,k,P,D,H,J,F,G,I,U,z,j,L,x;o._RF.push({},"eec54urUmNAcaenfr4Djz/P","MaJiang_HH_UI",void 0);var O=a.ccclass,R=a.property;t("MaJiang_HH_UI",(v=O("MaJiang_HH_UI"),A=R(s),S=R(c),M=R(c),k=R(c),P=R(c),D=R(c),H=R(c),v((G=e((F=function(t){function e(){for(var e,i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return(e=t.call.apply(t,[this].concat(o))||this)._logic=null,n(e,"skinSpArr",G,r(e)),n(e,"targetNode",I,r(e)),n(e,"newTargetPrefab",U,r(e)),n(e,"tips",z,r(e)),n(e,"btn_down",j,r(e)),n(e,"btn_combine",L,r(e)),n(e,"btn_sort",x,r(e)),e.unlockNewGridArr=[],e.newTargetCount=0,e.maxTarget=8,e}i(e,t);var o=e.prototype;return o.onLoad=function(){this._logic=this.node.parent.getComponent(_)},o.onEnable=function(){for(var t=0;t<this.skinSpArr.length;t++){var e=w.instance.getOneAsset(C.GameUI,"mj_pf_"+(B.getPlayerData().skinId_Use+1)+"_1",l);this.skinSpArr[t].spriteFrame=e}this.schedule(this.showTips,15),this.schedule(this.showDownTips,5)},o.showDownTips=function(){this._logic.isNewer||(this.btn_down.getChildByName("fingerAni").active=!0)},o.resetShowDownTips=function(){this.unschedule(this.showDownTips),this.btn_down.getChildByName("fingerAni").active=!1,this.schedule(this.showDownTips,5)},o.showTips=function(){this.unlockNewGridArr.length<=0||(this.tips.getChildByName("root").getChildByName("MJPrefab").getChildByName("mj").getComponent(s).spriteFrame=this.getMJSpriteFrame(this.unlockNewGridArr[0]),this.tips.getComponent(g).play())},o.getMJSpriteFrame=function(t){var e="";return t<=9?e="mj_w_0"+t:t>9&&t<=18?e="mj_b_0"+(t-9):t>18&&t<=27&&(e="mj_t_0"+(t-18)),w.instance.getOneAsset(C.GameUI,e,l)},o.initTargetArr=function(t){this.targetNode.getChildByName("ProgressBar").getComponent(u).progress=0,this.targetNode.getChildByName("per").getComponent(h).string="0%";for(var e=1;e<=5;e++){var i=this.targetNode.children[e],n=i.getChildByName("mj"),r=i.getChildByName("tick");n.getComponent(s).spriteFrame=this.getMJSpriteFrame(t[e-1]),r.active=!1}this.unlockNewGridArr.push(this._logic.curTarget+3),this.unlockNewGridArr.push(this._logic.curTarget+4),this.unlockNewGridArr.push(this._logic.curTarget+5),this.unlockNewGridArr.push(this._logic.curTarget+7)},o.createNewTarget=function(t){if(!(t<=this._logic.curTarget)){this._logic.curTarget++,this.newTargetCount++,this.targetNode.getChildByName("ProgressBar").getComponent(u).progress=this.newTargetCount/this.maxTarget,this.targetNode.getChildByName("per").getComponent(h).string=(this.newTargetCount/this.maxTarget*100).toFixed(1)+"%";var e=this._logic.targetArr.indexOf(t);if(-1!=e){var i=this.targetNode.getChildByName("MJ"+(e+1)),n=N.getWorldPos(i),r=p(this.newTargetPrefab);this.node.addChild(r),r.active=!0,r.position=m(),r.getChildByName("MJPrefab").getChildByName("mj").getComponent(s).spriteFrame=this.getMJSpriteFrame(t);var o=this.node.getComponent(d).convertToNodeSpaceAR(n);f(r).by(1,{position:m(0,100)}).parallel(f(r).to(.5,{position:o}),f(r).to(.5,{scale:m(.6,.6,1)})).call((function(){i.getChildByName("tick").active=!0,r.destroy()})).start()}}},o.btnDownCB=function(){this.resetShowDownTips(),this._logic.btnDownCB()},o.btnCombineCB=function(){this._logic.btnCombineCB()},o.btnSortCB=function(){this._logic.btnSortCB()},o.btnPauseCB=function(){T.Share.onShowSetPopUI()},o.update=function(t){var e=this._logic.checkCanCombine();this.btn_combine.getComponent(y).interactable=e,this.btn_combine.getChildByName("sp1").active=!e,this.btn_combine.getChildByName("sp2").active=e},e}(b)).prototype,"skinSpArr",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),I=e(F.prototype,"targetNode",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=e(F.prototype,"newTargetPrefab",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=e(F.prototype,"tips",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=e(F.prototype,"btn_down",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=e(F.prototype,"btn_combine",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=e(F.prototype,"btn_sort",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=F))||J));o._RF.pop()}}}));

System.register("chunks:///_virtual/MaJiang_HT_Logic.ts",["./rollupPluginModLoBabelHelpers.js","cc","./MaJiang_HT_UI.ts","./DynamicAssetManager.ts","./Utility.ts","./SGAD.ts","./GameLogic.ts","./SoundMgr.ts","./Entity.ts","./UIManager.ts","./UserGuide2.ts"],(function(e){"use strict";var t,i,n,o,r,a,l,d,s,h,g,c,u,p,f,m,C,y,N,v,_,b,M,T,G,S,B,A,I;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,n=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){r=e.cclegacy,a=e._decorator,l=e.Node,d=e.instantiate,s=e.Sprite,h=e.SpriteFrame,g=e.v3,c=e.find,u=e.tween,p=e.Tween,f=e.UITransform,m=e.Animation,C=e.view,y=e.Component,N=e.size},function(e){v=e.MaJiang_HT_UI},function(e){_=e.default,b=e.AssetsIdName},function(e){M=e.default},function(e){T=e.default},function(e){G=e.GameLogic},function(e){S=e.SoundMgr},function(e){B=e.UIType},function(e){A=e.default},function(e){I=e.UserGuide}],execute:function(){var w,J,E,P,j,k,D,H,O,x,R,F,U,z,W,L,Y,V,q,K,Q,X,Z,$,ee;r._RF.push({},"20be3cNl4JHnaqFyLcGa5f1","MaJiang_HT_Logic",void 0);var te=a.ccclass,ie=a.property;e("MaJiang_HT_Logic",(w=te("MaJiang_HT_Logic"),J=ie(l),E=ie(l),P=ie(l),j=ie(l),k=ie(l),D=ie(l),H=ie(l),O=ie(l),x=ie(l),R=ie(l),F=ie(l),w((W=t((z=function(e){function t(){for(var t,i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))||this)._ui=null,n(t,"MJPrefab",W,o(t)),n(t,"DoubleMJPrefab",L,o(t)),n(t,"gridNode",Y,o(t)),n(t,"combineNode",V,o(t)),n(t,"Effect_Chi",q,o(t)),n(t,"Effect_Peng",K,o(t)),n(t,"Effect_Gang",Q,o(t)),n(t,"block",X,o(t)),n(t,"changeTips",Z,o(t)),n(t,"loseTips",$,o(t)),n(t,"readyNode",ee,o(t)),t.readyGridNode=null,t.TotalTypeArr=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34],t.typeArr=[],t.mjSpaceY=83,t.readyGridMax=5,t.targetCount=120,t.gridCountMax=2,t.isChanging=!1,t.changeArr=[],t.isGameOver=!1,t.isNewer=!1,t.finishCount=0,t}i(t,e);var r=t.prototype;return r.onEnable=function(){this._ui=this.getComponentInChildren(v),this.readyGridNode=this.readyNode.getChildByName("gridNode"),this.isNewer="1"!=localStorage.getItem("HT_IsNewer"),localStorage.getItem("HT_FinishCount")?this.finishCount=parseInt(localStorage.getItem("HT_FinishCount")):this.finishCount=0,this.isNewer?this.createGuideGrid():(this.initGridData(),this.createGrid())},r.getNewDoubleMJ=function(e){var t=d(this.DoubleMJPrefab);return t.name=e.toString(),t.getChildByName("bg").getChildByName("mj1").getComponent(s).spriteFrame=this.getMJSpriteFrame(e[0]),t.getChildByName("bg").getChildByName("mj2").getComponent(s).spriteFrame=this.getMJSpriteFrame(e[1]),t.getChildByName("block").getComponent(s).spriteFrame=_.instance.getOneAsset(b.GameUI,"mj_pf_"+M.GetRandom(1,7)+"_4",h),t},r.getNewMJ=function(e){var t=d(this.MJPrefab);return t.name=e.toString(),t.getChildByName("bg").getChildByName("mj").getComponent(s).spriteFrame=this.getMJSpriteFrame(e),t.getChildByName("block").getComponent(s).spriteFrame=_.instance.getOneAsset(b.GameUI,"mj_pf_"+M.GetRandom(1,7)+"_2",h),t},r.getMJSpriteFrame=function(e){var t="";return e<=9?t="mj_w_0"+e:e>9&&e<=18?t="mj_b_0"+(e-9):e>18&&e<=27?t="mj_t_0"+(e-18):e>27&&e<=34?(28==e&&(t="mj_o_0d"),29==e&&(t="mj_o_0n"),30==e&&(t="mj_o_0x"),31==e&&(t="mj_o_0b"),32==e&&(t="mj_o_0z"),33==e&&(t="mj_o_0f"),34==e&&(t="mj_o_0w")):35==e&&(t="mj_l_0-1"),_.instance.getOneAsset(b.GameUI,t,h)},r.createGuideGrid=function(){var e=this,t=this.getNewDoubleMJ([1,2]),i=this.getNewDoubleMJ([10,10]),n=this.getNewDoubleMJ([19,19]),o=this.getNewDoubleMJ([19,19]),r=this.getNewMJ(3),a=this.getNewMJ(10);a.getChildByName("block").active=!0,this.gridNode.children[2].addChild(t),t.position=g(0,0),this.gridNode.children[3].addChild(r),r.position=g(0,0),this.gridNode.children[2].insertChild(i,0),i.position=g(0,this.mjSpaceY),this.gridNode.children[3].insertChild(a,0),a.position=g(0,this.mjSpaceY),this.gridNode.children[4].addChild(n),n.position=g(0,0),this.gridNode.children[4].addChild(o),o.position=g(0,this.mjSpaceY),t.on(l.EventType.TOUCH_END,(function(){e.clickMjCB(t)}),this),i.on(l.EventType.TOUCH_END,(function(){e.clickMjCB(i)}),this),n.on(l.EventType.TOUCH_END,(function(){e.clickMjCB(n)}),this),o.on(l.EventType.TOUCH_END,(function(){e.clickMjCB(o)}),this),r.on(l.EventType.TOUCH_END,(function(){e.clickMjCB(r)}),this),a.on(l.EventType.TOUCH_END,(function(){e.clickMjCB(a)}),this),this.scheduleOnce((function(){c("Canvas").getComponent(I).setGuideTextPos("center"),c("Canvas").getComponent(I).setGuideTextBackgroundScale(1.5,1.5),c("Canvas").getComponent(I).setGuideTextFontSize(32),c("Canvas").getComponent(I).setGuideSignScale(1.2,1.2),c("Canvas").getComponent(I).showGuideByGroup([21,22,23,24,25],(function(){e.scheduleOnce((function(){c("Canvas").getComponent(I).showGuideByGroup([26],(function(){e.gameOver(!0)}))}),.1)}))}))},r.initGridData=function(){this.gridCountMax=30+10*this.finishCount,this.targetCount=3*this.gridCountMax+this.gridCountMax/2;for(var e=0;e<3*this.gridCountMax;e++){var t={};if(Math.random()<.5){var i=M.getRandomItemInArr(this.TotalTypeArr);t={origin:[i,i],target:[i]}}else{var n=[].concat(this.TotalTypeArr);n.splice(26,8);var o=M.getRandomItemInArr(n);t.origin=9==o||18==o||27==o?[o-1,o]:[o,o+1],1==t.origin[0]?t.target=[3]:9==t.origin[1]?t.target=[7]:10==t.origin[0]?t.target=[12]:18==t.origin[1]?t.target=[16]:19==t.origin[0]?t.target=[21]:27==t.origin[1]?t.target=[25]:Math.random()<.5?t.target=[t.origin[0]-1]:t.target=[t.origin[1]+1]}this.typeArr.push(t)}for(var r=this.gridCountMax/2,a=0;a<r;a++){var l=M.getRandomItemInArr(this.TotalTypeArr),d={origin:[l,l],target:[l,l]};this.typeArr.push(d)}},r.getEmptyGridId=function(e){for(var t=[0,3,6],i=[1,2,4,5],n=[],o=0;o<this.gridNode.children.length;o++){if(!e||-1==t.indexOf(o))if(e||-1==i.indexOf(o))this.gridNode.children[o].children.length<this.gridCountMax&&n.push(o)}return n},r.createGrid=function(){for(var e=this,t=[],i=[],n=0;n<this.typeArr.length;n++){var o=this.typeArr[n],r=o.origin,a=o.target;1==r.length?i.push(r):t.push(r),1==a.length?i.push(a):t.push(a)}for(var d=function(){var i=t[s],n=M.getRandomItemInArr(e.getEmptyGridId(!0)),o=e.getNewDoubleMJ(i);e.gridNode.children[n].insertChild(o,0),o.position=g(0,(e.gridNode.children[n].children.length-1)*e.mjSpaceY),o.on(l.EventType.TOUCH_END,(function(){e.clickMjCB(o)}),e),o.getChildByName("block").active=M.getWorldPos(o).y>=700&&1*Math.random()<.15},s=0;s<t.length;s++)d();for(var h=function(){var t=i[c],n=M.getRandomItemInArr(e.getEmptyGridId(!1)),o=e.getNewMJ(t[0]);e.gridNode.children[n].insertChild(o,0),o.position=g(0,(e.gridNode.children[n].children.length-1)*e.mjSpaceY),o.on(l.EventType.TOUCH_END,(function(){e.clickMjCB(o)}),e),o.getChildByName("block").active=M.getWorldPos(o).y>=700&&1*Math.random()<.15},c=0;c<i.length;c++)h()},r.clickMjCB=function(e){M.DoVibrate();var t=e.name.split(",");if(this.isChanging){if(S._ins.PlaySound("MaJiang_HH_Select"),-1!=this.changeArr.indexOf(e))return;if(0==this.changeArr.length)return u(e).to(.25,{scale:g(.95,.95,1)}).to(.25,{scale:g(.9,.9,1)}).union().repeatForever().start(),this.changeArr.push(e),void this.showMjMask(1!=t.length,!0);if(1==this.changeArr.length){if(e.name.split(",").length!=this.changeArr[0].name.split(",").length)return;this.hideAllMjMask(),p.stopAllByTarget(this.changeArr[0]),this.changeArr[0].scale=g(.9,.9,1),this.changeArr.push(e),this.changeMJ()}}else{var i=this.getEmptyReadyGridId();if(i>this.readyGridMax)return S._ins.PlaySound("MaJiang_CD_Wrong"),void this.shakeNode(e.getChildByName("bg"));if(i==this.readyGridMax&&t.length>1)return S._ins.PlaySound("MaJiang_CD_Wrong"),void this.shakeNode(e.getChildByName("bg"));if(0!=e.position.y)return S._ins.PlaySound("MaJiang_CD_Wrong"),void this.shakeNode(e.getChildByName("bg"));S._ins.PlaySound("MaJiang_HH_Select");var n=e.parent;e.off(l.EventType.TOUCH_END),e.getChildByName("block").active=!1;var o=this.checkCanCombine(t);if(-1==o){var r=M.getWorldPos(e);this.readyGridNode.addChild(e),e.position=this.readyGridNode.getComponent(f).convertToNodeSpaceAR(r);var a=1==t.length?g(72*i-252,0):g(72*i-252+36,0);u(e).parallel(u(e).to(.1,{position:a}),u(e).to(.1,{scale:g(1,1,1)})).call((function(){})).start(),this.getEmptyReadyGridId()>this.readyGridMax&&(this.loseTips.active=!0)}else{var d=M.getWorldPos(e);this.combineNode.addChild(e),e.position=this.combineNode.getComponent(f).convertToNodeSpaceAR(d);var s=1==t.length?g(-36,0):g(-72,0);u(e).parallel(u(e).to(.1,{position:s}),u(e).to(.1,{scale:g(1,1,1)})).delay(1).call((function(){e.destroy()})).start();var h=this.readyGridNode.children[o],c=M.getWorldPos(h);this.combineNode.addChild(h),h.position=this.combineNode.getComponent(f).convertToNodeSpaceAR(c);var m=1==h.name.split(",").length?g(36,0):g(72,0);u(h).to(.1,{position:m}).delay(1).call((function(){h.destroy()})).start(),this.sortReadyGrid(),this.targetCount--,this.targetCount<=0&&this.gameOver(!0)}this.downGrid(n)}},r.checkCanCombine=function(e){for(var t=0;t<this.readyGridNode.children.length;t++){var i=this.readyGridNode.children[t].name.split(",");if(1!=e.length||1!=i.length)if(1==e.length){if(i[0]!=i[1]){if(-1!=this.getTargetByOrigin(i).indexOf(parseInt(e[0])))return S._ins.PlaySound("MaJiang_CD_Chi"),this.Effect_Chi.getComponent(m).play(),t}else if(e[0]==i[0]&&e[0]==i[1])return S._ins.PlaySound("MaJiang_CD_Peng"),this.Effect_Peng.getComponent(m).play(),t}else if(1==i.length){if(e[0]!=e[1]&&-1!=this.getTargetByOrigin(e).indexOf(parseInt(i[0])))return S._ins.PlaySound("MaJiang_CD_Chi"),this.Effect_Chi.getComponent(m).play(),t;if(e[0]==i[0]&&e[1]==i[0])return S._ins.PlaySound("MaJiang_CD_Peng"),this.Effect_Peng.getComponent(m).play(),t}else if(2==i.length&&e[0]==i[0]&&e[0]==i[1]&&e[1]==i[0]&&e[1]==i[1])return S._ins.PlaySound("wh_woman_gang"),this.Effect_Gang.getComponent(m).play(),t}return-1},r.getTargetByOrigin=function(e){for(var t=[],i=0;i<e.length;i++)t.push(parseInt(e[i]));return 1==t[0]?[3]:9==t[1]?[7]:10==t[0]?[12]:18==t[1]?[16]:19==t[0]?[21]:27==t[1]?[25]:[t[0]-1,t[1]+1]},r.getEmptyReadyGridId=function(){for(var e=0,t=0;t<this.readyGridNode.children.length;t++){e+=this.readyGridNode.children[t].name.split(",").length}return e},r.setMjContentSize=function(e,t){!function e(i){if(i.getComponent(f).contentSize=N(t?72:144,102),i.children.length>0)for(var n=0;n<i.children.length;n++)e(i.children[n])}(e)},r.downGrid=function(e){for(var t=e.children.length-1;t>=0;t--){var i=e.children[t],n=g(0,(e.children.length-1-t)*this.mjSpaceY);u(i).to(.1,{position:n}).call((function(){})).start()}},r.sortReadyGrid=function(){for(var e=0,t=0;t<this.readyGridNode.children.length;t++){var i=this.readyGridNode.children[t],n=i.name.split(","),o=1==n.length?g(72*e-252,0):g(72*e-252+36,0);u(i).to(.1,{position:o}).start(),e+=n.length}},r.adUnlockGrid=function(){var e=this;(this.readyNode.getChildByName("bgNode").getChildByName("bg7").getChildByName("ad")||this.readyNode.getChildByName("bgNode").getChildByName("bg8").getChildByName("ad"))&&T.showVideoAd((function(){(e.readyNode.getChildByName("bgNode").getChildByName("bg7").getChildByName("ad")||e.readyNode.getChildByName("bgNode").getChildByName("bg8").getChildByName("ad")).destroy(),e.readyGridMax+=1,e.loseTips.active=!1}))},r.changeMJ=function(){var e=this.changeArr[0],t=this.changeArr[1],i=e.getSiblingIndex(),n=t.getSiblingIndex(),o=e.parent,r=t.parent,a=e.position.clone(),l=t.position.clone(),d=M.getWorldPos(e),s=M.getWorldPos(t);o.removeChild(e),r.removeChild(t),o.insertChild(t,i),r.insertChild(e,n),e.position=r.getComponent(f).convertToNodeSpaceAR(d),t.position=o.getComponent(f).convertToNodeSpaceAR(s),u(e).to(.1,{position:l}).start(),u(t).to(.1,{position:a}).start(),this.changeArr=[],this.isChanging=!1,this.changeTips.active=!1},r.showMjMask=function(e,t){this.hideAllMjMask();for(var i=e?[0,3,6]:[1,2,4,5],n=0;n<i.length;n++){this.gridNode.children[i[n]].children.forEach((function(e){e.getChildByName("mask").active=t}))}},r.hideAllMjMask=function(){for(var e=0;e<this.gridNode.children.length;e++){this.gridNode.children[e].children.forEach((function(e){e.getChildByName("mask").active=!1}))}},r.resetCB=function(){var e=this;T.showVideoAd((function(){e.block.active=!0;for(var t=0;t<e.gridNode.children.length;t++){for(var i=e.gridNode.children[t],n=0;n<i.children.length;n++){i.children[n].setSiblingIndex(M.GetRandom(0,i.children.length))}for(var o=i.children.length-1;o>=0;o--){var r=i.children[o],a=g(0,(i.children.length-1-o)*e.mjSpaceY);u(r).to(.2,{position:a}).call((function(){})).start()}}e.scheduleOnce((function(){e.block.active=!1}),.3)}))},r.changeCB=function(){for(var e=this,t=0,i=0,n=[0,3,6],o=[1,2,4,5],r=0;r<n.length;r++){t+=this.gridNode.children[n[r]].children.length}for(var a=0;a<o.length;a++){i+=this.gridNode.children[o[a]].children.length}t<2&&i<2||T.showVideoAd((function(){e.changeArr=[],e.isChanging=!0,e.changeTips.active=!0}))},r.allCB=function(){var e=this;this.readyGridNode.children.length<=0||T.showVideoAd((function(){var t=e.readyGridNode.children[0],i=t.name.split(",");1==i.length||i[0]==i[1]?(S._ins.PlaySound("MaJiang_CD_Peng"),e.Effect_Peng.getComponent(m).play()):(S._ins.PlaySound("MaJiang_CD_Chi"),e.Effect_Chi.getComponent(m).play());var n=M.getWorldPos(t);e.combineNode.addChild(t),t.position=e.combineNode.getComponent(f).convertToNodeSpaceAR(n);var o=g(1==t.name.split(",").length?36:72,0);u(t).to(.1,{position:o}).delay(1).call((function(){t.destroy()})).start();var r=g(550,80),a=null;(a=1==t.name.split(",").length?e.getNewDoubleMJ([35,35]):e.getNewMJ(35)).scale=g(1,1,1),e.combineNode.addChild(a),a.position=e.combineNode.getComponent(f).convertToNodeSpaceAR(r);var l=g(1==a.name.split(",").length?-36:-72,0);u(a).to(.1,{position:l}).delay(1).call((function(){a.destroy()})).start(),e.sortReadyGrid(),e.targetCount--,e.targetCount<=0&&e.gameOver(!0),e.loseTips.active=!1}))},r.restartCB=function(){this.node.destroy(),A.GetInstance().closePage(b.MaJiang_HT,B.MaJiang_HT),G.Share.gameStart_HT()},r.gameOver=function(e){var t=this;this.isGameOver||(this.isGameOver=!0,console.log(e?"胜利":"失败"),e?(this.block.active=!0,S._ins.PlaySound("MaJiang_HH_Complete"),localStorage.getItem("HT_IsNewer")?(localStorage.getItem("HT_FinishCount")?localStorage.setItem("HT_FinishCount",(parseInt(localStorage.getItem("HT_FinishCount"))+1).toString()):localStorage.setItem("HT_FinishCount","1"),this.scheduleOnce((function(){G.Share.onOtherGameFinishPopUI([M.GetRandom(40,100)])}),2)):(localStorage.setItem("HT_IsNewer","1"),this.scheduleOnce((function(){t.block.active=!1,t.restartCB()}),2))):(this.loseTips.active=!0,this.scheduleOnce((function(){t.loseTips.isValid&&(t.loseTips.active=!1)}),5)))},r.shakeNode=function(e,t,i,n){void 0===t&&(t=3),void 0===i&&(i=.15),void 0===n&&(n=4),p.stopAllByTarget(e),e.position=g();var o=0,r=e.position.clone();!function a(){var l=g(Math.random()*(2*t)-t+r.x,Math.random()*(2*t)-t+r.y);u(e).to(i/n,{position:l}).call((function(){++o<n?a():e.position=r})).start()}()},r.update=function(e){for(var t=0;t<this.gridNode.children.length;t++)for(var i=this.gridNode.children[t],n=0;n<i.children.length;n++){var o=i.children[n];o.active=M.getWorldPos(o).y<C.getVisibleSize().height-150}},t}(y)).prototype,"MJPrefab",[J],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=t(z.prototype,"DoubleMJPrefab",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Y=t(z.prototype,"gridNode",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=t(z.prototype,"combineNode",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=t(z.prototype,"Effect_Chi",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=t(z.prototype,"Effect_Peng",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Q=t(z.prototype,"Effect_Gang",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),X=t(z.prototype,"block",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Z=t(z.prototype,"changeTips",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),$=t(z.prototype,"loseTips",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ee=t(z.prototype,"readyNode",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=z))||U));r._RF.pop()}}}));

System.register("chunks:///_virtual/MaJiang_HT_UI.ts",["./rollupPluginModLoBabelHelpers.js","cc","./MaJiang_HT_Logic.ts","./GameLogic.ts","./Entity.ts"],(function(t){"use strict";var i,e,n,o,r,a,l,c,u,s,g,h;return{setters:[function(t){i=t.applyDecoratedDescriptor,e=t.inheritsLoose,n=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,a=t._decorator,l=t.Node,c=t.Label,u=t.Component},function(t){s=t.MaJiang_HT_Logic},function(t){g=t.GameLogic},function(t){h=t.UIType}],execute:function(){var _,p,f,b,y,C,I,d,m;r._RF.push({},"86963T3qi9BwKIqW7sEAxYy","MaJiang_HT_UI",void 0);var T=a.ccclass,v=a.property;t("MaJiang_HT_UI",(_=T("MaJiang_HT_UI"),p=v(l),f=v(l),b=v(c),_((I=i((C=function(t){function i(){for(var i,e=arguments.length,r=new Array(e),a=0;a<e;a++)r[a]=arguments[a];return(i=t.call.apply(t,[this].concat(r))||this)._logic=null,n(i,"title",I,o(i)),n(i,"ruleNode",d,o(i)),n(i,"targetNum",m,o(i)),i}e(i,t);var r=i.prototype;return r.onLoad=function(){this._logic=this.node.parent.getComponent(s)},r.onEnable=function(){this.title.children[0].active=!localStorage.getItem("HT_IsNewer"),this.title.children[1].active="1"==localStorage.getItem("HT_IsNewer")},r.btn_pauseCB=function(){this._logic.isChanging||g.Share.onShowSetPopUI()},r.btn_resetCB=function(){this._logic.isChanging||this._logic.resetCB()},r.btn_changeCB=function(){this._logic.isChanging||this._logic.changeCB()},r.btn_allCB=function(){this._logic.isChanging||this._logic.allCB()},r.visibleRule=function(){g.Share.onShowPopUI(h.RulePopUI)},r.update=function(t){this.targetNum.string=this._logic.targetCount.toString()},i}(u)).prototype,"title",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),d=i(C.prototype,"ruleNode",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),m=i(C.prototype,"targetNum",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=C))||y));r._RF.pop()}}}));

System.register("chunks:///_virtual/PHGame_Layer1.ts",["./rollupPluginModLoBabelHelpers.js","cc","./PHGame_PreBlockAction.ts","./GameLogic.ts","./MainGameController.ts","./Utility.ts","./PHGame_LayerRootAction.ts","./BoardController.ts","./SoundMgr.ts"],(function(t){"use strict";var e,n,o,i,r,a,c,l,s,u,d,_,h,p,b,f,m,g,y,v,C,k,B,A,P,w;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,o=t.initializerDefineProperty,i=t.assertThisInitialized},function(t){r=t.cclegacy,a=t._decorator,c=t.Prefab,l=t.SpriteFrame,s=t.Input,u=t.instantiate,d=t.Vec3,_=t.RigidBody2D,h=t.BoxCollider2D,p=t.ERigidBody2DType,b=t.tween,f=t.UITransform,m=t.Vec2,g=t.UIOpacity,y=t.Component},function(t){v=t.PHGame_PreBlockAction},function(t){C=t.GameLogic},function(t){k=t.CardItem},function(t){B=t.default},function(t){A=t.PHGame_LayerRootAction},function(t){P=t.BoardController},function(t){w=t.SoundMgr}],execute:function(){var D,I,T,G,R,x,L,H,S,U,N,O,z;r._RF.push({},"a9117jhzYlBIbw/8iWJFpci","PHGame_Layer1",void 0);var E=a.ccclass,M=a.property;t("PHGame_Layer1",(D=E("PHGame_Layer1"),I=M({type:c}),T=M({type:c}),G=M({type:c}),R=M({type:c}),x=M({type:[l]}),D((S=e((H=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,o(e,"board",S,i(e)),o(e,"pre_block_one",U,i(e)),o(e,"pre_block_double",N,i(e)),o(e,"cun_down_eff",O,i(e)),o(e,"types_array",z,i(e)),e.cur_block_action=null,e.blockIsOne=!0,e.pre_block=null,e.isInCutBuff=!1,e.BoardArr=[],e.lastNum=0,e}n(e,t);var r=e.prototype;return r.start=function(){this.node.on(s.EventType.TOUCH_START,this.touch_start,this),this.node.on(s.EventType.TOUCH_END,this.touch_end,this),this.node.on(s.EventType.TOUCH_CANCEL,this.touch_cancel,this)},r.onDisable=function(){},r.update=function(t){},r.find_canCut=function(){this.isInCutBuff=!0;for(var t=0;t<this.node.children.length;t++){var e=this.node.children[t].getComponent(v);null!=e&&(1==e.CardItem.isDouble?e.showTip():e.hideTip())}},r.get_children=function(){return this.node.children},r.clear_all=function(){this.node.removeAllChildren()},r.start_game=function(t){for(var e=0;e<10;e++){var n=u(this.board);n.setPosition(new d(0,-135-113*this.BoardArr.length)),n.setParent(this.node);var o=n.getComponent(P),i=B.GetRandom(0,6);this.lastNum>=4&&(i=B.GetRandom(0,3)),o.init(i),this.lastNum=i,this.BoardArr.push(o)}this.onActivateAllRigb()},r.onAllBoardMoveUp=function(t){var e=this;console.log("!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!");for(var n=t;n<this.node.children.length;n++){var o=this.node.children[n].getComponent(_),i=this.node.children[n].getComponent(h);console.log("rig",o,"box",i),null!=o&&null!=i&&(o.type=p.Static,b(this.node.children[n]).to(.5,{position:new d(this.node.children[n].position.x,this.node.children[n].position.y+113)}).call((function(){})).start())}this.scheduleOnce((function(){e.onActivateAllRigb()}),1)},r.CreateEndBoard=function(t){var e=this.BoardArr.length-1,n=u(this.board),o=this.BoardArr[e];n.setPosition(new d(0,o.node.position.y-113)),n.setParent(this.node);var i=n.getComponent(P),r=B.GetRandom(0,6);this.lastNum>=4&&(r=B.GetRandom(0,3)),i.init(r),this.lastNum=r,this.BoardArr.push(i),this.onAllBoardMoveUp(t)},r.onActivateAllRigb=function(){for(var t=0;t<this.node.children.length;t++)if("Board"!=this.node.children[t].name){var e=this.node.children[t].getComponent(_);null!=e&&(e.type=p.Dynamic)}for(var n=0;n<this.BoardArr.length-1;n++){this.BoardArr[n].rigidbody.type=p.Dynamic}},r.get_touch_block=function(t){for(var e=this.node.getComponent(f).convertToNodeSpaceAR(new d(t.x,t.y)),n=this.node.children.length-1;n>=0;n--){var o=this.node.children[n];if(o.active){var i=o.getComponent(v);if(null!=i&&i.get_bounding_box().contains(new m(e.x,e.y)))return i}}return null},r.touch_start=function(t){var e=t.getUILocation(),n=this.get_touch_block(e);this.cur_block_action=n,this.cur_block_action&&this.cur_block_action.play_start_tween()},r.touch_end=function(t){var e=this;if(this.isInCutBuff){var n=u(this.cun_down_eff);n.setPosition(this.cur_block_action.node.position),n.setParent(this.node);var o=n.getChildByName("liewen"),i=n.getChildByName("futou"),r=n.getChildByName("guang");i.active=!0,r.active=!0,b(r.getComponent(g)).to(.5,{opacity:255}).start(),B.DoVibrate(),w._ins.PlaySound("FuTou2"),b(i).to(.3,{angle:50}).call((function(){o.active=!0,e.scheduleOnce((function(){var t=e.cur_block_action.CardItem,o=u(e.pre_block_one),i=u(e.pre_block_one);o.setPosition(e.cur_block_action.node.position.x-36,e.cur_block_action.node.position.y),o.setParent(e.node),i.setPosition(e.cur_block_action.node.position.x+36,e.cur_block_action.node.position.y),i.setParent(e.node);var r=new k(0,t.name,t.double_num_1,t.double_num_1,t.double_num_1,!0),a=new k(0,t.name,t.double_num_2,t.double_num_2,t.double_num_2,!0),c=o.getComponent(v),l=i.getComponent(v);c.isDouble=0,c.isDouble=0,c.init(r),l.init(a);var s=e.cur_block_action.BoardCtr;c.BoardCtr=s,s.CardArr.push(c),l.BoardCtr=s,s.CardArr.push(l);var d=s.CardArr.indexOf(e.cur_block_action);s.CardArr.splice(d,1),e.cur_block_action.node.active=!1,e.cur_block_action.node.destroy(),n.active=!1,n.destroy(),e.isInCutBuff=!1}),.3)})).start();for(var a=0;a<this.node.children.length;a++){var c=this.node.children[a].getComponent(v);null!=c&&(1==c.CardItem.isDouble&&c.hideTip())}}else{var l=t.getUILocation();if(this.cur_block_action){this.cur_block_action.play_end_tween();var s=this.get_touch_block(l);if(this.cur_block_action==s){var d;if(this.node.parent.getComponent(A).get_layer_3_size()+(this.cur_block_action.CardItem.isDouble+1)>this.node.parent.getComponent(A).get_layer_3_canUse())return C.Share.onShowGameTipUI(1),B.DoVibrate(),void w._ins.PlaySound("WuXiao");B.DoVibrate(),w._ins.PlaySound("XuanZe"),d=0==this.cur_block_action.CardItem.isDouble?u(this.pre_block_one):u(this.pre_block_double),this.node.parent.getComponent(A).to_3_from_1(this.cur_block_action,d);var _=this.cur_block_action.BoardCtr,h=_.CardArr.indexOf(this.cur_block_action);if(_.CardArr.splice(h,1),_.CardArr.length<=0){var p=this.node.children.indexOf(_.node),f=this.BoardArr.indexOf(_);this.BoardArr.splice(f,1),_.node.destroy(),this.CreateEndBoard(p)}this.cur_block_action.node.destroy()}}}},r.touch_cancel=function(t){this.cur_block_action&&this.cur_block_action.play_end_tween()},r.get_block_size=function(){return this.node.children.length},e}(y)).prototype,"board",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=e(H.prototype,"pre_block_one",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=e(H.prototype,"pre_block_double",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=e(H.prototype,"cun_down_eff",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=e(H.prototype,"types_array",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),L=H))||L));r._RF.pop()}}}));

System.register("chunks:///_virtual/PHGame_Layer2.ts",["./rollupPluginModLoBabelHelpers.js","cc","./PHGame_PreBlockAction.ts","./PHGame_LayerRootAction.ts","./SoundMgr.ts","./Utility.ts"],(function(t){"use strict";var o,n,e,i,c,r,a,_,u,s,l,h,d,p,f,y;return{setters:[function(t){o=t.applyDecoratedDescriptor,n=t.inheritsLoose,e=t.initializerDefineProperty,i=t.assertThisInitialized},function(t){c=t.cclegacy,r=t._decorator,a=t.Node,_=t.Input,u=t.UITransform,s=t.Vec3,l=t.Vec2,h=t.Component},function(t){d=t.PHGame_PreBlockAction},function(t){p=t.PHGame_LayerRootAction},function(t){f=t.SoundMgr},function(t){y=t.default}],execute:function(){var b,g,k,v,m;c._RF.push({},"39adaxCPZFDh49DqnRrQbWg","PHGame_Layer2",void 0);var P=r.ccclass,L=r.property;t("PHGame_Layer2",(b=P("PHGame_Layer2"),g=L({type:a}),b((m=o((v=function(t){function o(){for(var o,n=arguments.length,c=new Array(n),r=0;r<n;r++)c[r]=arguments[r];return o=t.call.apply(t,[this].concat(c))||this,e(o,"LayerRootAction",m,i(o)),o.cur_block_action=null,o}n(o,t);var c=o.prototype;return c.start=function(){this.node.on(_.EventType.TOUCH_START,this.touch_start,this),this.node.on(_.EventType.TOUCH_END,this.touch_end,this),this.node.on(_.EventType.TOUCH_CANCEL,this.touch_cancel,this)},c.update=function(t){},c.get_block_size=function(){return this.node.children.length},c.get_zero_world_position=function(){return this.node.getComponent(u).convertToWorldSpaceAR(new s(0,0,0))},c.add_block=function(t){t.node.setPosition(0,0),t.node.setParent(this.node)},c.get_touch_block=function(t){for(var o=this.node.getComponent(u).convertToNodeSpaceAR(new s(t.x,t.y)),n=this.node.children.length-1;n>=0;n--){var e=this.node.children[n];if(e.active){var i=e.getComponent(d);if(i.can_touch()&&i.get_bounding_box().contains(new l(o.x,o.y)))return i}}return null},c.touch_start=function(t){var o=t.getUILocation(),n=this.get_touch_block(o);this.cur_block_action=n,this.cur_block_action&&this.cur_block_action.play_start_tween()},c.touch_end=function(t){var o=t.getUILocation();if(this.cur_block_action){this.cur_block_action.play_end_tween();var n=this.get_touch_block(o);if(this.cur_block_action==n){var e=this.cur_block_action.node.getWorldPosition();1==this.cur_block_action.isDouble&&(e=new s(e.x+36,e.y)),this.cur_block_action.set_temp_pos(e),y.DoVibrate(),f._ins.PlaySound("XuanZe"),this.LayerRootAction.getComponent(p).to_3_from_2(this.cur_block_action)}}},c.touch_cancel=function(t){this.cur_block_action&&this.cur_block_action.play_end_tween()},c.clear_all=function(){this.node.removeAllChildren()},o}(h)).prototype,"LayerRootAction",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=v))||k));c._RF.pop()}}}));

System.register("chunks:///_virtual/PHGame_Layer3.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Utility.ts","./DynamicAssetManager.ts","./SGAD.ts","./SoundMgr.ts"],(function(e){"use strict";var t,o,n,r,i,s,l,a,d,u,_,c,h,m,p,b,f,C,g,v;return{setters:[function(e){t=e.applyDecoratedDescriptor,o=e.inheritsLoose,n=e.initializerDefineProperty,r=e.assertThisInitialized,i=e.createForOfIteratorHelperLoose},function(e){s=e.cclegacy,l=e._decorator,a=e.Node,d=e.Vec3,u=e.tween,_=e.UITransform,c=e.instantiate,h=e.SpriteFrame,m=e.Sprite,p=e.Component},function(e){b=e.default},function(e){f=e.default,C=e.AssetsIdName},function(e){g=e.default},function(e){v=e.SoundMgr}],execute:function(){var y,P,D,I,x,O,w,B,k,G,A,S,z,T,F;s._RF.push({},"e29f7QaFutIypQ5xyWH1me8","PHGame_Layer3",void 0);var N=l.ccclass,R=l.property;e("PHGame_Layer3",(y=N("PHGame_Layer3"),P=R({type:a}),D=R({type:a}),I=R({type:a}),x=R({type:a}),O=R({type:a}),w=R({type:a}),y((G=t((k=function(e){function t(){for(var t,o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return t=e.call.apply(e,[this].concat(i))||this,n(t,"slot_arr",G,r(t)),n(t,"Complete_One",A,r(t)),n(t,"Complete_Double",S,r(t)),n(t,"Complete_OneOne",z,r(t)),n(t,"Complete_Tip",T,r(t)),n(t,"CenterBox",F,r(t)),t.Placement_One=void 0,t.Placement_Double=void 0,t.order_list=[],t.GetCardPushBox=null,t.CanUseBlockNum=0,t.useBlockNum=0,t.GetCardArr=[0,0,0,0,0,0,-1,-1],t}o(t,e);var s=t.prototype;return s.start=function(){this.CanUseBlockNum=0;for(var e=0;e<this.GetCardArr.length;e++)0==this.GetCardArr[e]&&this.CanUseBlockNum++;this.GetCardPushBox=b.FindFunc(this.node,"GetCardPushBox"),this.Placement_One=b.FindFunc(this.node,"Placement_One"),this.Placement_Double=b.FindFunc(this.node,"Placement_Double"),this.onUpdateGetCardBox()},s.update=function(e){},s.reset_order=function(){for(var e=0;e<this.order_list.length;e++){var t=0,o=this.order_list[e];if(this.order_list.length>1)for(var n=this.order_list[0],r=0;r<this.order_list.length;r++)n!=o&&(1==n.CardItem.isDouble&&(t+=72),n=this.order_list[r+1]);var i=new d(this.slot_arr[e].getPosition().x+t,this.slot_arr[e].getPosition().y,this.slot_arr[e].getPosition().z);1==o.CardItem.isDouble&&(i=new d(i.x+36,i.y,i.z)),o.set_temp_pos(i),o.node.getParent()==this.node&&u(o.node).to(.1,{position:o.get_temp_pos()}).start()}},s.GetCardBoxVideoBtnCB=function(){var e=this;g.showVideoAd((function(){var t=e.GetCardArr.indexOf(-1);e.GetCardArr[t]=0,e.onUpdateGetCardBox(),e.CanUseBlockNum++}),(function(){b.showToast("看完视频才能获得奖励哦！")}))},s.pushCardCb=function(){if(!(this.order_list.length<=0)){var e=this.order_list[0];0==e.isDouble?this.Placement_One.position:this.Placement_Double.position,this.set_block_size(-(e.CardItem.isDouble+1))}},s.onUpdateGetCardBox=function(){for(var e=0;e<this.GetCardPushBox.children.length;e++)this.GetCardArr[e],this.GetCardPushBox.children[e]},s.get_slot_position=function(e){for(var t,o=[],n=!1,r=!1,s=i(this.order_list);!(t=s()).done;){var l=t.value;l.get_sprite_index()===e.get_sprite_index()?(n=!0,o.push(l)):(n&&!r&&(o.push(e),r=!0),o.push(l))}return r||o.push(e),this.order_list.splice(0,this.order_list.length),this.order_list=o,this.set_block_size(e.CardItem.isDouble+1),this.reset_order(),this.node.getComponent(_).convertToWorldSpaceAR(e.get_temp_pos())},s.add=function(e){var t=this.node.getComponent(_).convertToNodeSpaceAR(e.node.getWorldPosition());e.node.setParent(this.node),e.node.setPosition(t),e.set_add_layer3_time()},s.onFindCard=function(e,t){var o,n=e.CardItem,r=t.CardItem;return"l"==n.name||"l"==r.name?o=t:(n.name==r.name&&(1==n.isDouble?(1==r.isDouble&&r.double_num_1==r.double_num_2&&n.double_num_1==r.double_num_1||0==r.isDouble&&r.double_num_1==r.double_num_2&&n.double_num_1==r.one_num||0==r.isDouble&&n.double_num_1!=n.double_num_2&&parseInt(r.one_num)==parseInt(n.double_num_1)-1||0==r.isDouble&&n.double_num_1!=n.double_num_2&&parseInt(r.one_num)==parseInt(n.double_num_2)+1)&&(o=t):(1==r.isDouble&&r.double_num_1==r.double_num_2&&n.one_num==r.double_num_1||1==r.isDouble&&r.double_num_1!=r.double_num_2&&parseInt(r.double_num_2)==parseInt(n.one_num)-1||1==r.isDouble&&r.double_num_1!=r.double_num_2&&parseInt(r.double_num_1)==parseInt(n.one_num)+1)&&(o=t)),o)},s.del_same_block=function(){for(var e=this,t=[],o=0;o<this.order_list.length;o++){var n=this.order_list[o];t.push(n);for(var r=o+1;r<this.order_list.length;r++){var s=this.order_list[r];if(n!=s&&(null!=this.onFindCard(n,s)&&t.push(s),t.length>=2))break}if(t.length>=2)break;t=[]}if(t.length>=2){for(var l,a=this.Complete_Double,p=!0,g=!1,y=1,P=i(t);!(l=P()).done;){var D=l.value;"l"==D.CardItem.name&&(g=!0),"l"!=D.CardItem.name&&0==D.CardItem.isDouble&&(p=!1,a=this.Complete_One),this.set_block_size(-(D.CardItem.isDouble+1))}g&&!p?a=this.Complete_OneOne:g&&p&&(a=this.Complete_One);var I=c(a);I.setParent(this.node),this.node.insertChild(I,2),I.setPosition(a.getPosition());for(var x,O=i(t);!(x=O()).done;){var w=x.value,B=this.order_list.indexOf(w);this.order_list.splice(B,1),w.node.setParent(this.node);var k=I.getComponent(_).convertToWorldSpaceAR(I.children[0].children[y].position),G=this.node.getComponent(_).convertToNodeSpaceAR(k);0==w.CardItem.isDouble&&a==this.Complete_One?(k=I.getComponent(_).convertToWorldSpaceAR(I.children[0].children[1].position),G=this.node.getComponent(_).convertToNodeSpaceAR(k)):0!=w.CardItem.isDouble&&a==this.Complete_One&&(k=I.getComponent(_).convertToWorldSpaceAR(I.children[0].children[2].position),G=this.node.getComponent(_).convertToNodeSpaceAR(k)),u(w.node).to(.2,{position:G}).call((function(){I.children[0].active=!0})).start(),y++}var A=c(this.Complete_Tip);A.setParent(this.node),this.node.insertChild(A,2);var S=t[0].CardItem,z=t[1].CardItem,T="tx_c";switch(p?T="tx_g":(1==S.isDouble&&S.double_num_1==S.double_num_2||1==z.isDouble&&z.double_num_1==z.double_num_2)&&(T="tx_p"),b.DoVibrate(),T){case"tx_c":v._ins.PlaySound("wh_woman_chi");break;case"tx_g":v._ins.PlaySound("wh_woman_gang");break;case"tx_p":v._ins.PlaySound("wh_woman_peng")}var F=f.instance.getOneAsset(C.GameUI,T,h);return A.children[1].getComponent(m).spriteFrame=F,A.setPosition(this.Complete_Tip.getPosition()),A.children[0].active=!0,A.children[1].active=!0,this.scheduleOnce((function(){A.children[2].active=!0,u(A.children[2]).to(.2,{angle:180}).start()}),.3),u(A.children[1]).to(.1,{position:new d(0,0)}).to(.1,{scale:new d(1.2,1.2,1.2)}).to(.1,{scale:new d(1,1,1)}).start(),this.scheduleOnce((function(){for(var e,o=i(t);!(e=o()).done;){var n=e.value;I.destroy(),A.destroy(),n.node.destroy()}}),1),this.scheduleOnce((function(){e.reset_order()}),.3),!0}return!1},s.get_block_size=function(){return this.useBlockNum},s.set_block_size=function(e){return this.useBlockNum+=e,this.useBlockNum},s.get_remove_blocks=function(){var e=this.order_list[0],t=this.order_list.indexOf(e);return t>=0&&(this.order_list.splice(t,1),e.set_temp_pos(e.node.getWorldPosition())),e},s.get_redo_block=function(){for(var e,t=null,o=i(this.order_list);!(e=o()).done;){var n=e.value;t?n.get_add_layer3_time()>t.get_add_layer3_time()&&(t=n):t=n}if(t){var r=this.order_list.indexOf(t);r>=0&&(this.order_list.splice(r,1),t.set_temp_pos(t.node.getWorldPosition()),t.node.destroy())}return t},s.clear_all=function(){for(var e,t=i(this.order_list);!(e=t()).done;){e.value.node.destroy()}this.order_list.splice(0,this.order_list.length)},t}(p)).prototype,"slot_arr",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),A=t(k.prototype,"Complete_One",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=t(k.prototype,"Complete_Double",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z=t(k.prototype,"Complete_OneOne",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T=t(k.prototype,"Complete_Tip",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),F=t(k.prototype,"CenterBox",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),B=k))||B));s._RF.pop()}}}));

System.register("chunks:///_virtual/PHGame_LayerRootAction.ts",["./rollupPluginModLoBabelHelpers.js","cc","./PHGame_Layer1.ts","./PHGame_Layer3.ts","./EventDispatcher.ts","./clientEvent.ts","./PHGame_PreBlockAction.ts","./EnumController.ts","./GameLogic.ts","./MainGameController.ts","./PHGame_Layer2.ts","./SGAD.ts","./Utility.ts"],(function(e){"use strict";var t,o,n,i,a,r,c,_,l,s,u,p,d,y,h,m,v,f,g,b,k,C,P;return{setters:[function(e){t=e.applyDecoratedDescriptor,o=e.inheritsLoose,n=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){a=e.cclegacy,r=e._decorator,c=e.AudioClip,_=e.AudioSource,l=e.UITransform,s=e.tween,u=e.instantiate,p=e.Component},function(e){d=e.PHGame_Layer1},function(e){y=e.PHGame_Layer3},function(e){h=e.EventDispatcher},function(e){m=e.clientEvent},function(e){v=e.PHGame_PreBlockAction},function(e){f=e.PHGameEvent},function(e){g=e.GameLogic},function(e){b=e.CardItem},function(e){k=e.PHGame_Layer2},function(e){C=e.default},function(e){P=e.default}],execute:function(){var A,G,H,z,w,S,O,R,B,E,T,L,N,D,F;a._RF.push({},"a015aAvf0hBRozySSOZ/qas","PHGame_LayerRootAction",void 0);var I=r.ccclass,U=r.property;e("PHGame_LayerRootAction",(A=I("PHGame_LayerRootAction"),G=U({type:d}),H=U({type:k}),z=U({type:k}),w=U({type:k}),S=U({type:y}),O=U({type:[c]}),A((E=t((B=function(e){function t(){for(var t,o=arguments.length,a=new Array(o),r=0;r<o;r++)a[r]=arguments[r];return t=e.call.apply(e,[this].concat(a))||this,n(t,"layer_1_action",E,i(t)),n(t,"layer_2_action_One",T,i(t)),n(t,"layer_2_action_Double",L,i(t)),n(t,"layer_3_action_Omnipotent",N,i(t)),n(t,"layer_3_action",D,i(t)),t.aduio_source=null,n(t,"audio_clip_array",F,i(t)),t.level=1,t.isHaveFlyBlock=!1,t}o(t,e);var a=t.prototype;return a.start=function(){this.load_layer_1_action(),this.aduio_source=this.node.getComponent(_),h.get_target().on(h.REMOVE_ACTION,this.remove,this)},a.onDisable=function(){},a.update=function(e){},a.load_layer_1_action=function(){this.layer_1_action||(this.layer_1_action=this.node.getChildByName("layer1").getComponent(d))},a.start_game=function(){this.load_layer_1_action(),this.layer_1_action.clear_all(),this.layer_2_action_One.clear_all(),this.layer_2_action_Double.clear_all(),this.layer_3_action.clear_all(),this.layer_1_action.start_game(this.level)},a.to_3_from_1=function(e,t){var o=this,n=e.clone_block(this.node,t),i=this.layer_3_action.get_slot_position(n),a=this.node.getComponent(l).convertToNodeSpaceAR(i);this.isHaveFlyBlock=!0,s(n.node).to(.05,{position:a}).call((function(){o.layer_3_action.add(n);var e=o.layer_3_action.del_same_block();o.isHaveFlyBlock=!1,e?(o.isHaveFlyBlock=!0,m.dispatchEvent(f.onUpdateCompleteNum),0==o.layer_1_action.get_block_size()&&0==o.layer_3_action.get_block_size()&&(1==o.level?(o.level++,o.start_game()):m.dispatchEvent(f.onGameOverEvent,[!0,!0]))):o.check_over()})).start()},a.to_3_from_2=function(e){var t=this;e.node.setParent(this.node),e.node.setPosition(this.node.getComponent(l).convertToNodeSpaceAR(e.get_temp_pos()));var o=this.layer_3_action.get_slot_position(e),n=this.node.getComponent(l).convertToNodeSpaceAR(o);this.isHaveFlyBlock=!0,s(e.node).to(.05,{position:n}).call((function(){t.layer_3_action.add(e);var o=t.layer_3_action.del_same_block();t.isHaveFlyBlock=!1,o?(t.isHaveFlyBlock=!0,m.dispatchEvent(f.onUpdateCompleteNum),0==t.layer_1_action.get_block_size()&&0==t.layer_3_action.get_block_size()&&m.dispatchEvent(f.onGameOverEvent,[!0,!0])):t.check_over()})).start()},a.check_over=function(){this.isHaveFlyBlock||this.get_layer_3_size()>=this.get_layer_3_canUse()&&m.dispatchEvent(f.onGameOverEvent,[!1,!0])},a.get_layer_3_size=function(){return this.layer_3_action.get_block_size()},a.get_layer_3_canUse=function(){return this.layer_3_action.CanUseBlockNum},a.play_sound=function(e){this.aduio_source.playOneShot(this.audio_clip_array[e])},a.click_random=function(){},a.click_cutdown=function(){var e=this;C.showVideoAd((function(){e.layer_1_action.find_canCut()}),(function(){P.showToast("看完视频才能获得奖励哦！")}))},a.click_getOmnipotent=function(){var e=this;C.showVideoAd((function(){var t=u(e.layer_1_action.pre_block_one),o=new b(0,"l","-1","-1","-1",!0),n=t.getComponent(v);n.init(o,!1,!0),n.set_temp_pos(n.node.getPosition());var i=e.layer_3_action_Omnipotent,a=e.node.getComponent(l).convertToNodeSpaceAR(i.get_zero_world_position());n.node.setPosition(e.node.getComponent(l).convertToNodeSpaceAR(n.get_temp_pos())),s(n.node).to(.1,{position:a}).call((function(){i.add_block(n)})).start()}),(function(){P.showToast("看完视频才能获得奖励哦！")}))},a.click_getOmnipotentCB=function(){g.Share.MainGameIsCanClick},a.click_remove=function(){var e=this;C.showVideoAd((function(){0!=e.layer_3_action.get_block_size()&&e.remove()}),(function(){P.showToast("看完视频才能获得奖励哦！")}))},a.click_removeCB=function(){g.Share.MainGameIsCanClick},a.remove=function(){var e=this.layer_3_action.get_remove_blocks();this.layer_3_action.reset_order();var t=this.layer_2_action_One;t=0==e.CardItem.isDouble?this.layer_2_action_One:this.layer_2_action_Double;var o=this.node.getComponent(l).convertToNodeSpaceAR(t.get_zero_world_position());e.node.setParent(this.node),e.node.setPosition(this.node.getComponent(l).convertToNodeSpaceAR(e.get_temp_pos())),this.layer_3_action.set_block_size(-(e.CardItem.isDouble+1)),s(e.node).to(.1,{position:o}).call((function(){t.add_block(e)})).start()},a.click_redo=function(){var e=this.layer_3_action.get_redo_block();if(e){e.node.setParent(this.node),e.node.setPosition(this.node.getComponent(l).convertToNodeSpaceAR(e.get_temp_pos()));var t=this.node.getComponent(l).convertToNodeSpaceAR(e.original.node.getWorldPosition());s(e.node).to(.15,{position:t}).call((function(){e.original.node.active=!0})).removeSelf().start(),this.layer_3_action.reset_order()}},t}(p)).prototype,"layer_1_action",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=t(B.prototype,"layer_2_action_One",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=t(B.prototype,"layer_2_action_Double",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=t(B.prototype,"layer_3_action_Omnipotent",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=t(B.prototype,"layer_3_action",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=t(B.prototype,"audio_clip_array",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),R=B))||R));a._RF.pop()}}}));

System.register("chunks:///_virtual/PHGame_PreBlockAction.ts",["./rollupPluginModLoBabelHelpers.js","cc","./DynamicAssetManager.ts","./clientEvent.ts","./EnumController.ts","./PlayerDataMgr.ts"],(function(e){"use strict";var t,n,i,o,s,r,a,d,c,l,m,u,h,p,_,g,f,y,C,v,I,B,b,P;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){s=e.cclegacy,r=e._decorator,a=e.Node,d=e.RigidBody2D,c=e.BoxCollider2D,l=e.UITransform,m=e.Rect,u=e.SpriteFrame,h=e.Sprite,p=e.ERigidBody2DType,_=e.tween,g=e.UIOpacity,f=e.Vec3,y=e.instantiate,C=e.Component},function(e){v=e.default,I=e.AssetsIdName},function(e){B=e.clientEvent},function(e){b=e.PHGameEvent},function(e){P=e.default}],execute:function(){var w,x,D,A,N;s._RF.push({},"6a427Iwj+RNDoPcNAlXVDUN","PHGame_PreBlockAction",void 0);var k=r.ccclass,G=r.property;e("PHGame_PreBlockAction",(w=k("PHGame_PreBlockAction"),x=G({type:a}),w((N=t((A=function(e){function t(){for(var t,n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(t=e.call.apply(e,[this].concat(s))||this).sprite_index=0,t.types_array=[],t.temp_pos=null,t.time_for_add_layer3=0,t.original=null,t.isDouble=0,t.CardItem=null,t.recordPos=null,t.isCompleteBlock=!1,t.rigidbody=null,t.boxCollider=null,t.BoardCtr=null,i(t,"BoomEff",N,o(t)),t.index=void 0,t}n(t,e);var s=t.prototype;return s.onLoad=function(){this.rigidbody=this.node.getComponent(d),this.boxCollider=this.node.getComponent(c)},s.start=function(){},s.update=function(e){this.onIsFlyToView()},s.onIsFlyToView=function(){(this.node.position.x>=450||this.node.position.x<=-450)&&B.dispatchEvent(b.onGameOverEvent,[!1,!1])},s.get_bounding_box=function(){return this.node.getComponent(l).getBoundingBox()},s.get_custom_bounding_box=function(){var e=this.get_bounding_box();this.get_bounding_box();return new m(e.x+15,e.y+15,e.width-30,e.height-30)},s.hide=function(){this.node.getChildByName("mask").active=!0},s.show=function(){this.node.getChildByName("mask").active=!1},s.hideTip=function(){this.node.getChildByName("tip").active=!1},s.showTip=function(){this.node.getChildByName("tip").active=!0},s.init=function(e,t,n){var i,o;if(void 0===n&&(n=!1),this.CardItem=e,null!=this.CardItem){if(0==this.CardItem.isDouble){i=v.instance.getOneAsset(I.GameUI,"mj_"+this.CardItem.name+"_0"+this.CardItem.one_num,u),this.node.children[1].getComponent(h).spriteFrame=i;var s=v.instance.getOneAsset(I.GameUI,"mj_pf_"+(P.getPlayerData().skinId_Use+1)+"_1",u);this.node.children[0].getComponent(h).spriteFrame=s}else{i=v.instance.getOneAsset(I.GameUI,"mj_"+this.CardItem.name+"_0"+this.CardItem.double_num_1,u),o=v.instance.getOneAsset(I.GameUI,"mj_"+this.CardItem.name+"_0"+this.CardItem.double_num_2,u),this.node.children[1].getComponent(h).spriteFrame=i,this.node.children[2].getComponent(h).spriteFrame=o;var r=v.instance.getOneAsset(I.GameUI,"mj_pf_"+(P.getPlayerData().skinId_Use+1)+"_3",u);this.node.children[0].getComponent(h).spriteFrame=r}this.recordPos=this.node.position,n?this.node.getComponent(c).sensor=!0:this.node.getComponent(d).type=p.Dynamic}else this.hide()},s.refresh_sprite=function(e){e&&_(this.node).to(.2,{position:this.temp_pos}).start()},s.cut_down=function(e){var t=this,n=this.node.getChildByName("liewen"),i=this.node.getChildByName("futou"),o=this.node.getChildByName("guang");i.active=!0,o.active=!0,_(o.getComponent(g)).to(.5,{opacity:255}).start(),_(i).to(.5,{angle:50}).call((function(){n.active=!0,t.scheduleOnce(e,.3)})).start()},s.get_sprite_index=function(){return this.sprite_index},s.set_sprite_index=function(e){this.sprite_index=e},s.can_touch=function(){return!this.node.getChildByName("mask").active},s.play_start_tween=function(){_(this.node).to(.1,{scale:new f(1.2,1.2,1)}).start()},s.play_end_tween=function(){_(this.node).to(.1,{scale:new f(1,1,1)}).start()},s.clone_block=function(e,n){var i=y(n),o=i.getComponent(t);i.setParent(e);var s=this.node.getWorldPosition(),r=e.getComponent(l).convertToNodeSpaceAR(s);return i.setPosition(r),o.show(),o.init(this.CardItem,!1,!0),o.refresh_sprite(!1),o.original=this,this.node.active=!1,o},s.set_temp_pos=function(e){this.temp_pos=e},s.get_temp_pos=function(){return this.temp_pos},s.set_add_layer3_time=function(){this.time_for_add_layer3=(new Date).getTime()},s.get_add_layer3_time=function(){return this.time_for_add_layer3},t}(C)).prototype,"BoomEff",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=A))||D));s._RF.pop()}}}));

System.register("chunks:///_virtual/PHGameController.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Utility.ts","./MainGameController.ts","./PHGame_LayerRootAction.ts"],(function(t){"use strict";var o,_,r,n,e,i,a,l,s,d,u;return{setters:[function(t){o=t.applyDecoratedDescriptor,_=t.inheritsLoose,r=t.initializerDefineProperty,n=t.assertThisInitialized},function(t){e=t.cclegacy,i=t._decorator,a=t.Node,l=t.Component},function(t){s=t.default},function(t){d=t.CardItem},function(t){u=t.PHGame_LayerRootAction}],execute:function(){var p,c,b,w,C,h,m,x,f,P;e._RF.push({},"c0090jSAtRKsqNYF88SURcs","PHGameController",void 0);var g=i.ccclass,S=i.property;t("PHGameController",(p=g("PHGameController"),c=S(a),b=S({type:u}),w=S({type:a}),p(((P=function(t){function o(){for(var o,_=arguments.length,e=new Array(_),i=0;i<_;i++)e[i]=arguments[i];return o=t.call.apply(t,[this].concat(e))||this,r(o,"CenterBox",m,n(o)),r(o,"layer_root_action",x,n(o)),r(o,"layer1",f,n(o)),o.DoubleCardBasePool=["b_1_1","b_1_2","b_2_2","b_2_3","b_3_3","b_3_4","b_4_4","b_4_5","b_5_5","b_5_6","b_6_6","b_6_7","b_7_7","b_7_8","b_8_8","b_8_9","b_9_9","w_1_1","w_1_2","w_2_2","w_2_3","w_3_3","w_3_4","w_4_4","w_4_5","w_5_5","w_5_6","w_6_6","w_6_7","w_7_7","w_7_8","w_8_8","w_8_9","w_9_9","t_1_1","t_1_2","t_2_2","t_2_3","t_3_3","t_3_4","t_4_4","t_4_5","t_5_5","t_5_6","t_6_6","t_6_7","t_7_7","t_7_8","t_8_8","t_8_9","t_9_9","o_d_d","o_x_x","o_n_n","o_b_b","o_z_z","o_f_f","o_w_w"],o.OneCardBasePool=["b_1","b_2","b_3","b_4","b_5","b_6","b_7","b_8","b_9","w_1","w_2","w_3","w_4","w_5","w_6","w_7","w_8","w_9","t_1","t_2","t_3","t_4","t_5","t_6","t_7","t_8","t_9","o_d","o_x","o_n","o_b","o_z","o_f","o_w"],o.InitAllCardPool=[],o.InitDoubleCardPool=[],o.InitCompleteCardPool=[],o.FirstAllCardPool=[],o.AllStratumCardPool=[[],[],[],[],[],[],[],[],[],[]],o.CardMaxNum=260,o.DoubleCradNum=0,o.OneCradNum=0,o}_(o,t);var e=o.prototype;return e.onLoad=function(){this.onInitCardPool()},e.onInitCardPool=function(){},e.onReorderCardPool=function(){var t,o,_=["b","w","t"],r=_[s.GetRandom(0,2)],n=s.GetRandom(1,9),e=new d(1,r,"-1",n.toString(),n.toString(),!0),i=new d(1,r,"-1",n.toString(),n.toString(),!0),a=_[s.GetRandom(0,2)],l=s.GetRandom(1,9),u=new d(0,a,l.toString(),l.toString(),l.toString(),!0),p=new d(1,a,"-1",l.toString(),l.toString(),!0),c=_[s.GetRandom(0,2)],b=s.GetRandom(1,9),w=s.GetRandom(0,1);b<3&&(w=1),b>7&&(w=0),0==w?(t=b-2,o=b-1):(t=b+1,o=b+2);var C=new d(1,c,"-1",t.toString(),o.toString(),!0),h=new d(0,c,b.toString(),b.toString(),b.toString(),!0);this.FirstAllCardPool.push(e),this.FirstAllCardPool.push(i),this.FirstAllCardPool.push(u),this.FirstAllCardPool.push(p),this.FirstAllCardPool.push(C),this.FirstAllCardPool.push(h)},e.onPushCompedCardToInitAllPool=function(t,o,_){var r,n=1;switch(n=this.DoubleCradNum<42?1:0,t){case"b":case"w":case"t":"1"!=o&&"9"!=_||(n=0),1==n&&o!=_&&(n=0),r=this.onGetNumCard(t,o,_,n);break;case"o":r=this.onGetOtherCard(t,o,_,n)}1==n?this.DoubleCradNum++:this.OneCradNum++,this.InitCompleteCardPool.push(r)},e.onGetOtherCard=function(t,o,_,r){return new d(r,t,o,o,o,!0)},e.onGetNumCard=function(t,o,_,r){var n="0",e="0",i="0",a=[];if(o==_)n=e=o,a.push(o);else{var l=parseInt(o)-1,u=parseInt(o)+2;"1"!=o&&a.push(l.toString()),"9"!=_&&a.push(u.toString()),parseInt(o)<3?(l=parseInt(o)+1,u=parseInt(o)+2):parseInt(o)>7&&(l=parseInt(o)-2,u=parseInt(o)-1),n=l.toString(),e=u.toString()}return 0==r?(i=a[s.GetRandom(0,1)],a.length<2&&(i=a[0]),n=e=o):i="-1",new d(r,t,i,n,e,!0)},e.onInitFixedStratumPool=function(){for(var t=0;t<this.AllStratumCardPool.length;t++);},o}(l)).stratumType_config=[{pos:[{x:-250,d:1},{x:250,d:1}]},{pos:[{x:-250,d:1},{x:0,d:1},{x:250,d:1}]},{pos:[{x:-250,d:1},{x:0,d:0},{x:250,d:1}]},{pos:[{x:-250,d:1},{x:-80,d:0},{x:80,d:0},{x:250,d:1}]},{pos:[{x:-260,d:0},{x:0,d:1},{x:260,d:0}]},{pos:[{x:-260,d:0},{x:-100,d:1},{x:100,d:1},{x:260,d:0}]},{pos:[{x:-260,d:0},{x:-145,d:0},{x:0,d:1},{x:145,d:0},{x:260,d:0}]}],m=o((h=P).prototype,"CenterBox",[c],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=o(h.prototype,"layer_root_action",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),f=o(h.prototype,"layer1",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=h))||C));e._RF.pop()}}}));

System.register("chunks:///_virtual/PHGamePopUI.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Utility.ts","./clientEvent.ts","./EnumController.ts","./Entity.ts","./DynamicAssetManager.ts","./UIManager.ts","./UI.ts","./SGAD.ts"],(function(t){"use strict";var n,e,o,i,s,c,a,l,u,r,h,d,p,f;return{setters:[function(t){n=t.inheritsLoose},function(t){e=t.cclegacy,o=t._decorator,i=t.tween,s=t.Vec3,c=t.Node},function(t){a=t.default},function(t){l=t.clientEvent},function(t){u=t.PHGameEvent},function(t){r=t.UIType},function(t){h=t.AssetsIdName},function(t){d=t.default},function(t){p=t.default},function(t){f=t.default}],execute:function(){var B;e._RF.push({},"e02c95MCj5PEaOcJi542rQm","PHGamePopUI",void 0);var I=o.ccclass;o.property,t("PHGamePopUI",I("PHGamePopUI")(B=function(t){function e(){for(var n,e=arguments.length,o=new Array(e),i=0;i<e;i++)o[i]=arguments[i];return(n=t.call.apply(t,[this].concat(o))||this).BoxBg=null,n.Title=null,n.Icon=null,n.Describe=null,n.CloseBtn=null,n.VideoBtn=null,n.CompleteCardNum=void 0,n.showFishIndex=0,n}n(e,t);var o=e.prototype;return o.onLoad=function(){this.CompleteCardNum=parseInt(this.parm[0][0]),this.BoxBg=a.FindFunc(this.node,"BoxBg"),this.Title=a.FindFunc(this.node,"Title"),this.Icon=a.FindFunc(this.node,"Icon"),this.Describe=a.FindFunc(this.node,"Describe"),this.CloseBtn=a.FindFunc(this.node,"CloseBtn"),this.VideoBtn=a.FindFunc(this.node,"VideoBtn"),this.InitUI()},o.onEnable=function(){var t=this;i(this.BoxBg).to(.3,{scale:new s(1,1,1)}).call((function(){i(t.CloseBtn).to(.3,{scale:new s(1,1,1)}).call((function(){t.CloseBtn.on(c.EventType.TOUCH_END,t.CloseBtnCB,t)})).start()})).start()},o.onDisable=function(){},o.start=function(){},o.InitUI=function(){this.BoxBg.scale=new s(0,0),i(this.BoxBg).to(.3,{scale:new s(1,1)}).start()},o.VideoBtnCB=function(){var t=this;f.showVideoAd((function(){l.dispatchEvent(u.onFinishAgainGame),i(t.BoxBg).to(.1,{scale:new s(0,0,0)}).call((function(){d.GetInstance().closePopup(h.PHGameUI,r.PHGamePopUI)})).start()}),(function(){a.showToast("看完视频才能获得奖励哦！")}))},o.CloseBtnCB=function(){var t=this;i(this.BoxBg).to(.1,{scale:new s(0,0,0)}).call((function(){d.GetInstance().closePopup(h.PHGameUI,r.PHGamePopUI),d.GetInstance().openPopup(h.MainUI,r.OtherGameFinishPopUI,!0,[t.CompleteCardNum])})).start()},e}(p))||B);e._RF.pop()}}}));

System.register("chunks:///_virtual/PHGameUI.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameLogic.ts","./Utility.ts","./GameData.ts","./clientEvent.ts","./PlayerDataMgr.ts","./SoundMgr.ts","./SGMgr.ts","./UI.ts","./DynamicAssetManager.ts","./Entity.ts","./SGAD.ts","./EnumController.ts","./PHGame_LayerRootAction.ts","./UIManager.ts"],(function(e){"use strict";var o,t,n,i,a,l,u,m,s,r,f,h,c,p,C,d,b,g,N,v,G,B,P,I,y;return{setters:[function(e){o=e.applyDecoratedDescriptor,t=e.inheritsLoose,n=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){a=e.cclegacy,l=e._decorator,u=e.Node,m=e.Label,s=e.ProgressBar,r=e.tween,f=e.Sprite},function(e){h=e.GameLogic},function(e){c=e.default},function(e){p=e.default},function(e){C=e.clientEvent},function(e){d=e.default},function(e){b=e.SoundMgr},function(e){g=e.default},function(e){N=e.default},function(e){v=e.AssetsIdName},function(e){G=e.UIType},function(e){B=e.default},function(e){P=e.PHGameEvent},function(e){I=e.PHGame_LayerRootAction},function(e){y=e.default}],execute:function(){var D,U,x,w,A,F,S,E,T,_,L;a._RF.push({},"d8530UzZm5HX4EBrNXBIvcP","PHGameUI",void 0);var M=l.ccclass,H=l.property;e("PHGameUI",(D=M("PHGameUI"),U=H({type:I}),x=H(u),w=H(u),A=H(u),D((E=o((S=function(e){function o(){for(var o,t=arguments.length,a=new Array(t),l=0;l<t;l++)a[l]=arguments[l];return o=e.call.apply(e,[this].concat(a))||this,n(o,"layer_root",E,i(o)),n(o,"TopBox",T,i(o)),n(o,"CenterBox",_,i(o)),n(o,"BottomBox",L,i(o)),o.Placement_One=null,o.Placement_Double=null,o.GetCardPushBox=null,o.SetBtn=null,o.RuleBtn=null,o.DoubleBtn=null,o.ClearNumLabel=null,o.CompleteBox=void 0,o.CompleteNewIcon=void 0,o.CompleteNumLabel=void 0,o.ComboBox=void 0,o.ComboNumLabel=void 0,o.ComboEff=void 0,o.ComboTexNode=void 0,o.level=1,o.level_add=0,o.level_need=0,o.pro_level=1,o.levelArr=[1,2,8,16,38,68,130],o.composeNum=0,o.composeMaxNum=50,o.GetCardArr=[0,0,0,0,0,0,-1,-1],o.effComboNum=0,o.comboTween=null,o.CompleteCardNum=0,o.isInDoubleBuff=!1,o.doubleBuffNum=0,o.isCanAgainGame=!0,o.isGameOver=!1,o}t(o,e);var a=o.prototype;return a.onLoad=function(){this.DoubleBtn=c.FindFunc(this.node,"DoubleBtn"),this.CompleteBox=c.FindFunc(this.node,"CompleteBox"),this.CompleteNewIcon=c.FindFunc(this.node,"CompleteNewIcon"),this.ComboBox=c.FindFunc(this.node,"ComboBox"),this.ComboEff=c.FindFunc(this.node,"ComboEff"),this.ComboTexNode=c.FindFunc(this.ComboEff,"ComboTexNode"),this.CompleteNumLabel=c.FindFunc(this.node,"CompleteNumLabel").getComponent(m),this.ComboNumLabel=c.FindFunc(this.node,"ComboNumLabel").getComponent(m),C.on(P.onUpdateCompleteNum,this.onUpdateCompleteNum,this),C.on(P.onFinishAgainGame,this.onFinishAgainGame,this),C.on(P.onAgainGameEvent,this.onAgainGame,this),C.on(P.onGameOverEvent,this.onGameOver,this)},a.start=function(){},a.onEnable=function(){g.inGame(),p.isStart=!0,this.initUI()},a.onDisable=function(){C.off(P.onUpdateCompleteNum,this.onUpdateCompleteNum,this),C.off(P.onFinishAgainGame,this.onFinishAgainGame,this),C.off(P.onAgainGameEvent,this.onAgainGame,this),C.off(P.onGameOverEvent,this.onGameOver,this)},a.initUI=function(){this.layer_root.start_game(),this.onUpdateCompleteNum(!0)},a.initTopBox=function(){},a.initBottomBox=function(){},a.onShowComboEff=function(){var e=this;this.effComboNum>=4&&(this.effComboNum=4);for(var o=0;o<this.ComboTexNode.children.length;o++)this.ComboTexNode.children[o].active=!1;this.ComboTexNode.children[this.effComboNum].active=!0,null!=this.comboTween&&(this.comboTween.stop(),this.comboTween=null);var t=this.ComboEff.children[1].getComponent(s);t.progress=0,this.ComboEff.active=!0,this.comboTween=r(t).to(5,{progress:1}).call((function(){e.effComboNum=0,e.comboTween=null,e.ComboEff.active=!1})),this.comboTween.start(),this.effComboNum++},a.onUpdateCompleteNum=function(e){void 0===e&&(e=!1),e||(this.isInDoubleBuff?this.CompleteCardNum+=1*(this.effComboNum+1)*2:this.CompleteCardNum+=1*(this.effComboNum+1),this.onShowComboEff()),this.CompleteCardNum>d.getPlayerData().PHGameMaxCompleteNum?(this.CompleteNewIcon.active=!0,d.getPlayerData().PHGameMaxCompleteNum=this.CompleteCardNum,d.setPlayerData()):this.CompleteNumLabel.string=d.getPlayerData().PHGameMaxCompleteNum.toString(),this.CompleteNumLabel.string=d.getPlayerData().PHGameMaxCompleteNum.toString(),this.ComboNumLabel.string=this.CompleteCardNum.toString()},a.SetBtnCB=function(){h.Share.onShowSetPopUI()},a.RuleBtnCB=function(){h.Share.onShowPopUI(G.RulePopUI)},a.DoubleBtnCB=function(){var e=this;this.isInDoubleBuff||B.showVideoAd((function(){e.isInDoubleBuff=!0,e.DoubleBtn.getComponent(f).fillRange=0,e.onUpdateDoubleMask(),e.schedule(e.onUpdateDoubleMask,1)}),(function(){c.showToast("看完视频才能获得奖励哦！")}))},a.onUpdateDoubleMask=function(){var e=this;this.isInDoubleBuff&&r(this.DoubleBtn.getComponent(f)).to(1,{fillRange:this.doubleBuffNum-.05}).call((function(){e.doubleBuffNum-=.05,e.DoubleBtn.getComponent(f).fillRange<=-1&&e.unschedule(e.onUpdateDoubleMask)})).start()},a.onGameOver=function(e){var o=e[0],t=e[1];this.isGameOver||(this.isGameOver=!0,b._ins.PlaySound("ShiBai"),this.isCanAgainGame&&!o&&t?this.onShowAgainPopUI():y.GetInstance().openPopup(v.MainUI,G.OtherGameFinishPopUI,!1,[this.CompleteCardNum]))},a.onShowAgainPopUI=function(){this.isCanAgainGame=!1,y.GetInstance().openPopup(v.PHGameUI,G.PHGamePopUI,!1,[this.CompleteCardNum])},a.onFinishAgainGame=function(){this.isGameOver=!1,this.layer_root.remove()},a.onAgainGame=function(){this.CompleteCardNum=0,this.isGameOver=!1,this.layer_root.start_game()},a.update=function(e){},o}(N)).prototype,"layer_root",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=o(S.prototype,"TopBox",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=o(S.prototype,"CenterBox",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=o(S.prototype,"BottomBox",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=S))||F));a._RF.pop()}}}));

System.register("chunks:///_virtual/resources",["./MaJiang_CD_Logic.ts","./MaJiang_CD_UI.ts","./BoomEffCtr.ts","./HCBlockCtr.ts","./HCGameController.ts","./HCGamePopUI.ts","./MaJiang_HH_Logic.ts","./MaJiang_HH_UI.ts","./MaJiang_HT_Logic.ts","./MaJiang_HT_UI.ts","./BoardController.ts","./PHGameController.ts","./PHGamePopUI.ts","./PHGameUI.ts","./PHGame_Layer1.ts","./PHGame_Layer2.ts","./PHGame_Layer3.ts","./PHGame_LayerRootAction.ts","./PHGame_PreBlockAction.ts"],(function(){"use strict";return{setters:[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

(function(r) {
  r('virtual:///prerequisite-imports/resources', 'chunks:///_virtual/resources'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});